"use strict";!function(t){window.InlineShortcodeView_vc_row=window.InlineShortcodeView.extend({column_tag:"vc_column",events:{mouseenter:"removeHoldActive"},layout:1,addControls:function(){return this.$controls=t('<div class="no-controls"></div>'),this.$controls.appendTo(this.$el),this},render:function(){var t=this.content();return t&&t.hasClass("vc_row-has-fill")&&(t.removeClass("vc_row-has-fill"),this.$el.addClass("vc_row-has-fill")),window.InlineShortcodeView_vc_row.__super__.render.call(this),this},removeHoldActive:function(){vc.unsetHoldActive()},addColumn:function(){vc.builder.create({shortcode:this.column_tag,parent_id:this.model.get("id")}).render()},addElement:function(t){t&&t.preventDefault&&t.preventDefault(),this.addColumn()},changeLayout:function(t){t&&t.preventDefault&&t.preventDefault(),this.layoutEditor().render(this.model).show()},layoutEditor:function(){return _.isUndefined(vc.row_layout_editor)&&(vc.row_layout_editor=new vc.RowLayoutUIPanelFrontendEditor({el:t("#vc_ui-panel-row-layout")})),vc.row_layout_editor},convertToWidthsArray:function(t){return _.map(t.split(/_/),function(t){var e=t.split("");return e.splice(Math.floor(t.length/2),0,"/"),e.join("")})},changed:function(){window.InlineShortcodeView_vc_row.__super__.changed.call(this),this.addLayoutClass()},content:function(){return!1===this.$content&&(this.$content=this.$el.find(".vc_container-anchor:first").parent()),this.$el.find(".vc_container-anchor:first").remove(),this.$content},addLayoutClass:function(){this.$el.removeClass("vc_layout_"+this.layout),this.layout=_.reject(vc.shortcodes.where({parent_id:this.model.get("id")}),function(t){return t.get("deleted")}).length,this.$el.addClass("vc_layout_"+this.layout)},convertRowColumns:function(t,o){if(!t)return!1;var n,r,s=[],e=this.convertToWidthsArray(t);return vc.layout_change_shortcodes=[],vc.layout_old_columns=vc.shortcodes.where({parent_id:this.model.get("id")}),_.each(vc.layout_old_columns,function(t){t.set("deleted",!0),s.push({shortcodes:vc.shortcodes.where({parent_id:t.get("id")}),params:t.get("params")})}),_.each(e,function(t){var e=s.shift();_.isObject(e)?(r=o.create({shortcode:this.column_tag,parent_id:this.model.get("id"),order:vc.shortcodes.nextOrder(),params:_.extend({},e.params,{width:t})}).last(),_.each(e.shortcodes,function(t){t.save({parent_id:r.get("id"),order:vc.shortcodes.nextOrder()},{silent:!0}),vc.layout_change_shortcodes.push(t)},this)):(n={width:t},r=o.create({shortcode:this.column_tag,parent_id:this.model.get("id"),order:vc.shortcodes.nextOrder(),params:n}).last())},this),_.each(s,function(t){_.each(t.shortcodes,function(t){t.save({parent_id:r.get("id"),order:vc.shortcodes.nextOrder()},{silent:!0}),vc.layout_change_shortcodes.push(t),t.view.rowsColumnsConverted&&t.view.rowsColumnsConverted()},this)},this),o.render(function(){_.each(vc.layout_change_shortcodes,function(t){t.trigger("change:parent_id"),t.view.rowsColumnsConverted&&t.view.rowsColumnsConverted()}),_.each(vc.layout_old_columns,function(t){t.destroy()}),vc.layout_old_columns=[],vc.layout_change_shortcodes=[]}),e},allowAddControl:function(){return"edit"!==vc_user_access().getState("shortcodes")},allowAddControlOnEmpty:function(){return"edit"!==vc_user_access().getState("shortcodes")}})}(window.jQuery);