"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(l){var d,u;window.wordfenceAdmin||(window.wordfenceAdmin={isSmallScreen:!1,loading16:'<div class="wfLoading16"></div>',loadingCount:0,dbCheckTables:[],dbCheckCount_ok:0,dbCheckCount_skipped:0,dbCheckCount_errors:0,issues:[],ignoreData:!1,iconErrorMsgs:[],scanIDLoaded:0,colorboxQueue:[],mode:"",visibleIssuesPanel:"new",preFirstScanMsgsLoaded:!1,newestActivityTime:0,elementGeneratorIter:1,reloadConfigPage:!1,nonce:!1,liveTrafficUpdatePending:!1,activityLogUpdatePending:!1,lastALogCtime:0,lastIssueUpdateTime:0,activityQueue:[],totalActAdded:0,maxActivityLogItems:1e3,scanReqAnimation:!1,debugOn:!1,blockedCountriesPending:[],ownCountry:"",schedStartHour:!1,currentPointer:!1,countryMap:!1,countryCodesToSave:"",performanceScale:3,performanceMinWidth:20,_windowHasFocus:!0,serverTimestampOffset:0,serverMicrotime:0,wfLiveTraffic:null,loadingBlockedIPs:!1,scanRunning:!1,basePageName:"",pendingChanges:{},scanStalled:!1,siteCleaningIssueTypes:["file","checkGSB","checkSpamIP","commentBadURL","knownfile","optionBadURL","postBadTitle","postBadURL","spamvertizeCheck","suspiciousAdminUsers"],SCREEN_XS:"xs",SCREEN_SM:"sm",SCREEN_MD:"md",SCREEN_LG:"lg",init:function(){this.isSmallScreen=window.matchMedia("only screen and (max-width: 500px)").matches,this.nonce=WordfenceAdminVars.firstNonce,this.debugOn="1"==WordfenceAdminVars.debugOn,this.scanRunning="1"==WordfenceAdminVars.scanRunning,this.basePageName=document.title;var t=this;l(window).on("blur",function(){t._windowHasFocus=!1}).on("focus",function(){t._windowHasFocus=!0}).focus(),l(".do-show").click(function(){var e=l(this);return e.hide(),l(e.data("selector")).show(),!1}),l(".downloadLogFile").each(function(){l(this).attr("href",WordfenceAdminVars.ajaxURL+"?action=wordfence_downloadLogFile&nonce="+WFAD.nonce+"&logfile="+encodeURIComponent(l(this).data("logfile")))}),l("#doSendEmail").click(function(){var e=l("#_ticketnumber").val();null!=e&&0!=e.length?WFAD.ajax("wordfence_sendDiagnostic",{email:l("#_email").val(),ticket:e},function(e){e.result?t.colorboxModal(t.isSmallScreen?"300px":"400px",u("Email Diagnostic Report"),u("Diagnostic report has been sent successfully.")):t.colorboxModal(t.isSmallScreen?"300px":"400px",u("Error"),u("There was an error while sending the email."))}):t.colorboxModal(t.isSmallScreen?"300px":"400px",u("Error"),u("Please include your support ticket number or forum username."))}),l("#exportDiagnostics").click(function(){return t.showLoading(),!(window.open(WordfenceAdminVars.ajaxURL+"?action=wordfence_exportDiagnostics&nonce="+WFAD.nonce).onbeforeunload=function(){t.removeLoading()})}),l("#sendByEmail").click(function(){l("#sendByEmailForm").removeClass("hidden"),l(this).hide()}),l("#expandAllDiagnostics").click(function(){l("#wf-diagnostics").find(".wf-block").each(function(){var e=l(this);e.hasClass("wf-active")||e.find(".wf-block-header").trigger("click")})}),l(window).bind("scroll",function(){200<l(this).scrollTop()?l(".wf-scrollTop").fadeIn():l(".wf-scrollTop").fadeOut()}),l(".wf-scrollTop").click(function(e){return e.stopPropagation(),l("body,html").animate({scrollTop:0},800),!1});var n=jQuery(".wf-page-tabs").find(".wf-tab a");if(0<n.length){if(n.click(function(){jQuery(".wf-page-tabs").find(".wf-tab").removeClass("wf-active").find("a").attr("aria-selected","false"),jQuery(".wf-tab-content").removeClass("wf-active");var e=jQuery(this).closest(".wf-tab");e.addClass("wf-active"),e.find("a").attr("aria-selected","true"),jQuery("#"+e.data("target")).addClass("wf-active"),document.title=e.data("pageTitle")+" ‹ "+t.basePageName,t.sectionInit(),l(window).trigger("wfTabChange",[e.data("target")])}),window.location.hash)for(var e=WFAD.parseHashes(),a=e[e.length-1],o=0;o<n.length;o++)a==jQuery(n[o]).closest(".wf-tab").data("target")&&jQuery(n[o]).trigger("click");else jQuery(n[0]).trigger("click");jQuery(window).on("hashchange",function(){for(var e=WFAD.parseHashes(),t=e[e.length-1],a=0;a<n.length;a++)t==jQuery(n[a]).closest(".wf-tab").data("target")&&jQuery(n[a]).trigger("click")})}else this.sectionInit();this.mode&&jQuery(document).bind("cbox_closed",function(){t.colorboxIsOpen=!1,t.colorboxServiceQueue()}),l(".wf-options-controls-spacer").length&&l(".update-nag, #update-nag").insertAfter(l(".wf-options-controls-spacer")),l(".wf-block-header-action-disclosure").each(function(){l(this).on("keydown",function(e){32==e.keyCode&&(e.preventDefault(),e.stopPropagation(),l(this).closest(".wf-block-header").trigger("click"))}),l(this).closest(".wf-block-header").css("cursor","pointer"),l(this).closest(".wf-block-header").on("click",function(e){var t;e.target&&"A"===e.target.nodeName&&e.target.href||(e.preventDefault(),e.stopPropagation(),l(this).closest(".wf-block").hasClass("wf-disabled")||((t=l(this).closest(".wf-block").hasClass("wf-active"))?l(this).closest(".wf-block").find(".wf-block-content").slideUp({always:function(){l(this).closest(".wf-block").removeClass("wf-active"),l(this).attr("aria-checked","false")}}):l(this).closest(".wf-block").find(".wf-block-content").slideDown({always:function(){l(this).closest(".wf-block").addClass("wf-active"),l(this).attr("aria-checked","true")}}),WFAD.ajax("wordfence_saveDisclosureState",{name:l(this).closest(".wf-block").data("persistenceKey"),state:!t},function(){},function(){},!0)))})}),l(".wf-option.wf-option-toggled .wf-option-checkbox").each(function(){l(this).on("keydown",function(e){32==e.keyCode&&(e.preventDefault(),e.stopPropagation(),l(this).trigger("click"))}),l(this).on("click",function(e){e.preventDefault(),e.stopPropagation();var t,a,n=l(this).closest(".wf-option");n.hasClass("wf-option-premium")||n.hasClass("wf-disabled")||(t=n.data("option"),a=!1,a=l(this).hasClass("wf-checked")?(l(this).removeClass("wf-checked").attr("aria-checked","false"),n.data("disabledValue")):(l(this).addClass("wf-checked").attr("aria-checked","true"),n.data("enabledValue")),n.data("originalValue")==a?delete WFAD.pendingChanges[t]:WFAD.pendingChanges[t]=a,l(n).trigger("change",[!1]),WFAD.updatePendingChanges())}),l(this).parent().find(".wf-option-title").on("click",function(e){for(var t=l(this).find("a"),a=0;a<t.length;a++){var n=l(t[a]).offset().top,o=l(t[a]).offset().left,i=n+l(t[a]).height(),s=o+l(t[a]).width();if(e.pageX>o-10&&e.pageX<s+10&&e.pageY>n-10&&e.pageY<i+10)return}l(this).parent().find(".wf-option-checkbox").trigger("click")}).css("cursor","pointer")}),l(".wf-option.wf-option-toggled-boolean-switch .wf-boolean-switch").each(function(){l(this).on("keydown",function(e){32==e.keyCode&&(e.preventDefault(),e.stopPropagation(),l(this).trigger("click"))}),l(this).on("click",function(e){e.preventDefault(),e.stopPropagation(),l(this).find(".wf-boolean-switch-handle").trigger("click")}),l(this).find(".wf-boolean-switch-handle").on("click",function(e){e.preventDefault(),e.stopPropagation();var t,a,n,o=l(this).closest(".wf-option");o.hasClass("wf-option-premium")||o.hasClass("wf-disabled")||(t=l(this).closest(".wf-boolean-switch"),a=o.data("option"),n=!1,n=t.hasClass("wf-active")?(t.removeClass("wf-active").attr("aria-checked","false"),o.data("disabledValue")):(t.addClass("wf-active").attr("aria-checked","true"),o.data("enabledValue")),o.data("originalValue")==n?delete WFAD.pendingChanges[a]:WFAD.pendingChanges[a]=n,l(o).trigger("change",[!1]),WFAD.updatePendingChanges())}),l(this).parent().find(".wf-option-title").on("click",function(e){for(var t=l(this).find("a"),a=0;a<t.length;a++){var n=l(t[a]).offset().top,o=l(t[a]).offset().left,i=n+l(t[a]).height(),s=o+l(t[a]).width();if(e.pageX>o-10&&e.pageX<s+10&&e.pageY>n-10&&e.pageY<i+10)return}l(this).parent().find(".wf-boolean-switch-handle").trigger("click")}).css("cursor","pointer")}),l(".wf-option.wf-option-toggled-segmented [type=radio]").each(function(){l(this).on("click",function(e){var t,a,n=l(this).closest(".wf-option");n.hasClass("wf-option-premium")||n.hasClass("wf-disabled")||(t=n.data("option"),a=this.value,n.data("originalValue")==a?delete WFAD.pendingChanges[t]:WFAD.pendingChanges[t]=a,l(n).trigger("change",[!1]),WFAD.updatePendingChanges())})}),l(".wf-option.wf-option-toggled-multiple .wf-option-checkbox").each(function(){l(this).on("keydown",function(e){32==e.keyCode&&(e.preventDefault(),e.stopPropagation(),l(this).trigger("click"))}),l(this).on("click",function(e){e.preventDefault(),e.stopPropagation();var t,a,n,o=l(this).closest(".wf-option");o.hasClass("wf-option-premium")||o.hasClass("wf-disabled")||(a=(t=l(this).closest("ul")).data("option"),n=!1,n=l(this).hasClass("wf-checked")?(l(this).removeClass("wf-checked").attr("aria-checked","false"),t.data("disabledValue")):(l(this).addClass("wf-checked").attr("aria-checked","true"),t.data("enabledValue")),t.data("originalValue")==n?delete WFAD.pendingChanges[a]:WFAD.pendingChanges[a]=n,l(o).trigger("change",[!1]),WFAD.updatePendingChanges())})}),l(".wf-option.wf-option-toggled-select .wf-option-checkbox").each(function(){l(this).on("keydown",function(e){32==e.keyCode&&(e.preventDefault(),e.stopPropagation(),l(this).trigger("click"))}),l(this).on("click",function(e){e.preventDefault(),e.stopPropagation();var t,a,n,o=l(this).closest(".wf-option");o.hasClass("wf-option-premium")||o.hasClass("wf-disabled")||(t=o.find(".wf-option-select select"),a=o.data("toggleOption"),n=!1,n=l(this).hasClass("wf-checked")?(l(this).removeClass("wf-checked").attr("aria-checked","false"),t.attr("disabled",!0),o.data("disabledToggleValue")):(l(this).addClass("wf-checked").attr("aria-checked","true"),t.attr("disabled",!1),o.data("enabledToggleValue")),o.data("originalToggleValue")==n?delete WFAD.pendingChanges[a]:WFAD.pendingChanges[a]=n,l(o).trigger("change",[!1]),WFAD.updatePendingChanges())}),l(this).parent().find(".wf-option-title").on("click",function(e){for(var t=l(this).find("a"),a=0;a<t.length;a++){var n=l(t[a]).offset().top,o=l(t[a]).offset().left,i=n+l(t[a]).height(),s=o+l(t[a]).width();if(e.pageX>o-10&&e.pageX<s+10&&e.pageY>n-10&&e.pageY<i+10)return}l(this).closest(".wf-option").find(".wf-option-checkbox").trigger("click")}).css("cursor","pointer")}),l(".wf-option.wf-option-toggled-select > .wf-option-content > ul > li.wf-option-select select, .wf-option.wf-option-select > .wf-option-content > ul > li.wf-option-select select, .wf-option.wf-option-select > li.wf-option-select select").each(function(){var e;l.fn.wfselect2&&(e=WFAD.isSmallScreen?"200px":"resolve",l(this).data("preferredWidth")&&(e=l(this).data("preferredWidth")),l(this).wfselect2({minimumResultsForSearch:-1,width:e}).on("change",function(){var e=l(this).closest(".wf-option"),t=e.data("selectOption"),a=l(this).val();e.data("originalSelectValue")==a?delete WFAD.pendingChanges[t]:WFAD.pendingChanges[t]=a,l(e).trigger("change",[!1]),WFAD.updatePendingChanges()}))}).triggerHandler("change"),l(".wf-option.wf-option-text > .wf-option-content > ul > li.wf-option-text input").on("change paste keyup",function(){var n=this;setTimeout(function(){var e,t=l(n).closest(".wf-option"),a=t.data("textOption");void 0!==a&&(e=l(n).val(),t.data("originalTextValue")==e?delete WFAD.pendingChanges[a]:WFAD.pendingChanges[a]=e,l(t).trigger("change",[!1]),WFAD.updatePendingChanges())},4)}),l(".wf-option.wf-option-textarea > .wf-option-content > ul > li.wf-option-textarea textarea").on("change paste keyup",function(){var n=this;setTimeout(function(){var e=l(n).closest(".wf-option"),t=e.data("textOption"),a=l(n).val();e.data("originalTextValue")==a?delete WFAD.pendingChanges[t]:WFAD.pendingChanges[t]=a,l(e).trigger("change",[!1]),WFAD.updatePendingChanges()},4)}),l.fn.wfselect2&&(l(".wf-option.wf-option-token select").wfselect2({tags:!0,tokenSeparators:[","],width:"element",minimumResultsForSearch:-1,selectOnClose:!0,matcher:function(){return null}}).on("wfselect2:unselect",function(e){jQuery(e.params.data.element).remove()}).on("wfselect2:opening wfselect2:close",function(e){l("body").toggleClass("wf-select2-suppress-dropdown","wfselect2:opening"==e.type)}).on("change",function(){var e=l(this).closest(".wf-option"),t=e.data("tokenOption"),a=l(this).val();a instanceof Array||(a=[]);var n=l(this).find("option:selected"),o=e.find(".wf-option-token-tags"),i=l("<ul>");n.each(function(e,t){var a=l('<li class="wf-tag-selected"><a class="wf-destroy-tag-selected">×</a>'+l(t).text()+"</li>");a.children("a.wf-destroy-tag-selected").off("click.wfselect2-copy").on("click.wfselect2-copy",function(e){var t=l(this).data("wfselect2-opt");t.prop("selected",!1),t.parents("select").trigger("change")}).data("wfselect2-opt",l(t)),i.append(a)}),o.html("").append(i);var s=e.data("originalTokenValue"),r=!0;if(a.length!=s.length)r=!1;else{a=a.sort(),s=s.sort();for(var c=0;c<a.length;c++)a[c]!==s[c]&&(r=!1)}r?delete WFAD.pendingChanges[t]:WFAD.pendingChanges[t]=a,l(e).trigger("change",[!1]),WFAD.updatePendingChanges()}).triggerHandler("change"),l(".wf-option.wf-option-token select").each(function(){l(this).data("wfselect2").$container.addClass("wf-select2-placeholder-fix wf-select2-hide-tags")})),l(".wf-option.wf-option-switch .wf-switch > li").each(function(e,t){l(this).on("keydown",function(e){32==e.keyCode&&(e.preventDefault(),e.stopPropagation(),l(this).trigger("click"))}),l(t).on("click",function(e){e.preventDefault(),e.stopPropagation();var t=l(this).closest("ul.wf-option-switch, div.wf-option-switch"),a=t.data("optionName"),n=t.data("originalValue"),o=l(this).data("optionValue");l(this).closest(".wf-switch").find("li").each(function(){l(this).toggleClass("wf-active",o==l(this).data("optionValue")).attr("aria-checked",o==l(this).data("optionValue")?"true":"false")}),n==o?delete WFAD.pendingChanges[a]:WFAD.pendingChanges[a]=o,l(t).trigger("change",[!1]),WFAD.updatePendingChanges()})}),l(document).focus(),l(document).on("click","a",function(){var e;this.href&&-1<this.href.indexOf("utm_source")||(e="","www.wordfence.com"!=this.host&&"wordfence.com"!=this.host||!/^\/help(?:$|\/)/.test(this.pathname)||(e="utm_source=plugin&utm_medium=pluginUI&utm_campaign=docsIcon"),e&&(e=(this.search?"&":"?")+e,this.href=this.protocol+"//"+this.host+this.pathname+this.search+e+this.hash),"http://support.wordfence.com/"==this.href&&(this.href="https://support.wordfence.com/support/home?utm_source=plugin&utm_medium=pluginUI&utm_campaign=supportLink"))})},sectionInit:function(){var e=this;this.mode=!1,0<jQuery("#wordfenceMode_dashboard:visible").length?this.mode="dashboard":0<jQuery("#wordfenceMode_scan:visible").length?this.mode="scan":0<jQuery("#wordfenceMode_waf:visible").length?this.mode="waf":0<jQuery("#wordfenceMode_liveTraffic:visible").length?(this.mode="liveTraffic",this.setupSwitches("wfLiveTrafficOnOff","liveTrafficEnabled",function(){}),jQuery("#wfLiveTrafficOnOff").change(function(){e.updateSwitch("wfLiveTrafficOnOff","liveTrafficEnabled",function(){window.location.reload(!0)})}),this.updateLiveTraffic(),0<this.liveInt&&(clearInterval(this.liveInt),this.liveInt=0),this.liveInt=setInterval(function(){e.updateLiveTraffic()},WordfenceAdminVars.actUpdateInterval)):0<jQuery("#wordfenceMode_twoFactor:visible").length?(this.mode="twoFactor",this.loadTwoFactor()):0<jQuery("#wordfenceMode_whois:visible").length?(this.mode="whois",this.calcRangeTotal()):0<jQuery("#wordfenceMode_scanScheduling:visible").length&&(this.mode="scanScheduling",this.sched_modeChange())},screenSize:function(e){switch(e){case WFAD.SCREEN_XS:return window.matchMedia("only screen and (max-width: 767px)").matches;case WFAD.SCREEN_SM:return window.matchMedia("only screen and (max-width: 991px)").matches;case WFAD.SCREEN_MD:return window.matchMedia("only screen and (max-width: 1199px)").matches;case WFAD.SCREEN_LG:return window.matchMedia("only screen and (max-width: 32767px)").matches}var t=parseInt(e);return!isNaN(t)&&window.matchMedia("only screen and (max-width: "+t+"px)").matches},sendTestEmail:function(e){var t=this;this.ajax("wordfence_sendTestEmail",{email:e},function(e){e.result&&t.colorboxModalHTML(t.isSmallScreen?"300px":"400px",u("Test Email Sent"),d(u("Your test email was sent to the requested email address. The result we received from the WordPress wp_mail() function was: %s<br /><br />A 'True' result means WordPress thinks the mail was sent without errors. A 'False' result means that WordPress encountered an error sending your mail. Note that it's possible to get a 'True' response with an error elsewhere in your mail system that may cause emails to not be delivered."),e.result))})},sendTestActivityReport:function(e){var t=this;this.ajax("wordfence_email_summary_email_address_debug",{email:e},function(e){e.result&&t.colorboxModalHTML(t.isSmallScreen?"300px":"400px","Test Activity Report",e.result)})},updateSwitch:function(e,t,a){jQuery("#"+e).is(":checked");this.updateConfig(t,jQuery("#"+e).is(":checked")?1:0,a)},setupSwitches:function(a,n,o){jQuery(".wfOnOffSwitch-checkbox").change(function(){jQuery.data(this,"lastSwitchChange",(new Date).getTime())});var i=this;jQuery("div.wfOnOffSwitch").mouseup(function(){var t=jQuery(this);setTimeout(function(){var e=t.find(".wfOnOffSwitch-checkbox");300<(new Date).getTime()-jQuery.data(e[0],"lastSwitchChange")&&(e.prop("checked",!e.is(":checked")),i.updateSwitch(a,n,o))},50)})},updateConfig:function(e,t,a){this.ajax("wordfence_updateConfig",{key:e,val:t},function(e){a&&a(e)})},updateIPPreview:function(e,t){this.ajax("wordfence_updateIPPreview",e,function(e){t&&t(e)})},tourFinish:function(e){WFAD.currentPointer&&(WFAD.currentPointer.pointer("destroy"),WFAD.currentPointer=!1),l("#wf-onboarding-tour-overlay").fadeOut(),WFAD.ajax("wordfence_tourClosed",{page:e},function(e){})},tour:function(e,t,a,n,o,i){WFAD.currentPointer&&(WFAD.currentPointer.pointer("destroy"),WFAD.currentPointer=!1);var s={pointerClass:"wf-tour-pointer",buttons:function(){return null},close:function(){},content:l("#"+e).tmpl().html(),pointerWidth:700,position:{edge:a,align:n}},r=l("#"+t);l("#wf-onboarding-tour-overlay").fadeIn(),WFAD.currentPointer=r.pointer(s).pointer("open"),o&&l("#wf-tour-previous a").on("click",function(e){e.preventDefault(),e.stopPropagation(),o()}),i&&l("#wf-tour-continue a").on("click",function(e){e.preventDefault(),e.stopPropagation(),i()}),l("#wf-tour-close").on("click",function(e){e.preventDefault(),e.stopPropagation(),WFAD.tourComplete()});var c=l(".wf-tour-pointer");0<c.length&&l("html, body").animate({scrollTop:c.offset().top-100},1e3)},showLoading:function(){this.loadingCount++,1==this.loadingCount&&l('<div id="wordfenceWorking">'+u("Wordfence is working...")+"</div>").appendTo("body")},removeLoading:function(){this.loadingCount--,0==this.loadingCount&&jQuery("#wordfenceWorking").remove()},switch2FAToNew:function(){},switch2FAToOld:function(){window.location.reload(!0)},startActivityLogUpdates:function(){var e=this;setInterval(function(){e.updateActivityLog()},parseInt(WordfenceAdminVars.actUpdateInterval))},updateActivityLog:function(){var t;this.activityLogUpdatePending||!this.windowHasFocus()&&"1"==WordfenceAdminVars.allowsPausing?jQuery("body").hasClass("wordfenceLiveActivityPaused")||this.activityLogUpdatePending||jQuery("body").addClass("wordfenceLiveActivityPaused"):(jQuery("body").hasClass("wordfenceLiveActivityPaused")&&jQuery("body").removeClass("wordfenceLiveActivityPaused"),WFAD.loadingIssues=!0,this.activityLogUpdatePending=!0,(t=this).ajax("wordfence_activityLogUpdate",{lastctime:this.lastALogCtime,lastissuetime:this.lastIssueUpdateTime},function(e){t.doneUpdateActivityLog(e)},function(){t.activityLogUpdatePending=!1},!0))},doneUpdateActivityLog:function(e){if(this.actNextUpdateAt=(new Date).getTime()+parseInt(WordfenceAdminVars.actUpdateInterval),e.ok){0<e.items.length&&(this.activityQueue.push.apply(this.activityQueue,e.items),this.lastALogCtime=e.items[e.items.length-1].ctime,this.processActQueue(e.currentScanID)),e.signatureUpdateTime&&this.updateSignaturesTimestamp(e.signatureUpdateTime);var t=WFAD.scanStalled;WFAD.scanStalled="1"==e.scanStalled;var a=WFAD.scanRunning;if(WFAD.scanRunning="1"==e.scanRunning&&!WFAD.scanStalled,e.scanFailedHTML&&!WFAD.scanRunning?(jQuery("#wf-scan-failed").html(e.scanFailedHTML),jQuery("#wf-scan-failed").show(),l(window).trigger("wfScanUpdateButtons")):jQuery("#wf-scan-failed").hide(),e.lastMessage&&l("#wf-scan-last-status").html(e.lastMessage),e.issues&&(this.lastIssueUpdateTime=e.issueUpdateTimestamp,this.displayIssues(e)),e.issueCounts&&WFAD.updateIssueCounts(e.issueCounts),WFAD.loadingIssues=!1,e.scanStats)for(var n=Object.keys(e.scanStats),o=0;o<n.length;o++)l("."+n[o]).text(e.scanStats[n[o]]);if(e.scanStages)for(n=Object.keys(e.scanStages),o=0;o<n.length;o++){var i,s,r=l("#wf-scan-"+n[o]);r&&(i=(i=r.attr("class")).match(/ /)?i.split(" "):[i],s=(s=e.scanStages[n[o]]).match(/ /)?s.split(" "):[s],(i.length!=s.length||i.filter(function(e){for(var t=0;t<s.length;t++)if(s[t]==e)return!0;return!1}).length!=s.length)&&(r.removeClass(),r.addClass(s.join(" "))),a!=WFAD.scanRunning?(WFAD.scanRunning?l("#wf-scan-running-bar").show():l("#wf-scan-running-bar").hide(),l(window).trigger("wfScanUpdateButtons")):t!=WFAD.scanStalled&&l(window).trigger("wfScanUpdateButtons"))}}this.activityLogUpdatePending=!1},updateSignaturesTimestamp:function(e){var t=new Date(1e3*e),a=t.toString();t.toLocaleString&&(a=t.toLocaleString());var n=l("#wf-scan-sigs-last-update"),o=d(u("Last Updated: %s"),a);n.text()!==o&&n.text(o).css({opacity:0}).animate({opacity:1},500)},processActQueue:function(){if(0<this.activityQueue.length){this.addActItem(this.activityQueue.shift()),this.totalActAdded++,this.totalActAdded>this.maxActivityLogItems&&(jQuery("#wf-scan-activity-log > li:first").remove(),this.totalActAdded--);for(var e=this.actNextUpdateAt-(new Date).getTime(),t=0;0<this.activityQueue.length&&.05<this.activityQueue.length/e;){var a=this.activityQueue.shift();a&&(t++,this.addActItem(a))}this.totalActAdded+=t,this.totalActAdded>this.maxActivityLogItems&&(jQuery("#wf-scan-activity-log > li:lt("+t+")").remove(),this.totalActAdded-=t);var n=100;(e<1||(n=Math.round(e/this.activityQueue.length))<100)&&(n=100);var o=this;setTimeout(function(){o.processActQueue()},n)}jQuery("#wf-scan-activity-log").scrollTop(jQuery("#wf-scan-activity-log").prop("scrollHeight"))},processActArray:function(e){for(var t=0;t<e.length;t++)this.addActItem(e[t])},addActItem:function(e){var t;e&&e.msg&&(0==e.msg.indexOf("SUM_")?this.processSummaryLine(e):(this.debugOn||e.level<4)&&(t='<li class="wfActivityLine',this.debugOn&&(t+=" wf"+e.type),t+='">['+e.date+"]&nbsp;"+e.msg+"</div>",jQuery("#wf-scan-activity-log").append(t),(/Scan complete\./i.test(e.msg)||/Scan interrupted\./i.test(e.msg))&&this.loadIssues()))},processSummaryLine:function(e){var t;-1!=e.msg.indexOf("SUM_START:")?(t=e.msg.replace("SUM_START:",""),jQuery("#consoleSummary").append('<div class="wfSummaryLine"><div class="wfSummaryDate">['+e.date+']</div><div class="wfSummaryMsg">'+t+'</div><div class="wfSummaryResult"><div class="wfSummaryLoading"></div></div><div class="wfClear"></div>')):-1!=e.msg.indexOf("SUM_ENDBAD")?(t=e.msg.replace("SUM_ENDBAD:",""),jQuery('div.wfSummaryMsg:contains("'+t+'")').next().addClass("wfSummaryBad").html("Problems found.")):-1!=e.msg.indexOf("SUM_ENDFAILED")?(t=e.msg.replace("SUM_ENDFAILED:",""),jQuery('div.wfSummaryMsg:contains("'+t+'")').next().addClass("wfSummaryBad").html("Failed.")):-1!=e.msg.indexOf("SUM_ENDOK")?(t=e.msg.replace("SUM_ENDOK:",""),jQuery('div.wfSummaryMsg:contains("'+t+'")').next().addClass("wfSummaryOK").html("Secure.")):-1!=e.msg.indexOf("SUM_ENDSUCCESS")?(t=e.msg.replace("SUM_ENDSUCCESS:",""),jQuery('div.wfSummaryMsg:contains("'+t+'")').next().addClass("wfSummaryOK").html("Success.")):-1!=e.msg.indexOf("SUM_ENDERR")?(t=e.msg.replace("SUM_ENDERR:",""),jQuery('div.wfSummaryMsg:contains("'+t+'")').next().addClass("wfSummaryErr").html("An error occurred.")):-1!=e.msg.indexOf("SUM_ENDSKIPPED")?(t=e.msg.replace("SUM_ENDSKIPPED:",""),jQuery('div.wfSummaryMsg:contains("'+t+'")').next().addClass("wfSummaryResult").html("Skipped.")):-1!=e.msg.indexOf("SUM_ENDIGNORED")?(t=e.msg.replace("SUM_ENDIGNORED:",""),jQuery('div.wfSummaryMsg:contains("'+t+'")').next().addClass("wfSummaryIgnored").html("Ignored.")):-1!=e.msg.indexOf("SUM_DISABLED:")?(t=e.msg.replace("SUM_DISABLED:",""),jQuery("#consoleSummary").append('<div class="wfSummaryLine"><div class="wfSummaryDate">['+e.date+']</div><div class="wfSummaryMsg">'+t+'</div><div class="wfSummaryResult">'+u("Disabled")+'</div><div class="wfClear"></div>')):-1!=e.msg.indexOf("SUM_PAIDONLY:")?(t=e.msg.replace("SUM_PAIDONLY:",""),jQuery("#consoleSummary").append('<div class="wfSummaryLine"><div class="wfSummaryDate">['+e.date+']</div><div class="wfSummaryMsg">'+t+'</div><div class="wfSummaryResult"><a href="https://www.wordfence.com/wordfence-signup/" target="_blank"  rel="noopener noreferrer">'+u("Paid Members Only")+" ("+u("opens in new tab")+')</a></div><div class="wfClear"></div>')):-1!=e.msg.indexOf("SUM_FINAL:")?(t=e.msg.replace("SUM_FINAL:",""),jQuery("#consoleSummary").append('<div class="wfSummaryLine"><div class="wfSummaryDate">['+e.date+']</div><div class="wfSummaryMsg wfSummaryFinal">'+t+'</div><div class="wfSummaryResult wfSummaryOK">'+u("Scan Complete.")+'</div><div class="wfClear"></div>')):-1!=e.msg.indexOf("SUM_PREP:")?(t=e.msg.replace("SUM_PREP:",""),jQuery("#consoleSummary").empty().html('<div class="wfSummaryLine"><div class="wfSummaryDate">['+e.date+']</div><div class="wfSummaryMsg">'+t+'</div><div class="wfSummaryResult" id="wfStartingScan"><div class="wfSummaryLoading"></div></div><div class="wfClear"></div>')):-1!=e.msg.indexOf("SUM_KILLED:")&&(t=e.msg.replace("SUM_KILLED:",""),jQuery("#consoleSummary").empty().html('<div class="wfSummaryLine"><div class="wfSummaryDate">['+e.date+']</div><div class="wfSummaryMsg">'+t+'</div><div class="wfSummaryResult wfSummaryOK">'+u("Scan Complete.")+'</div><div class="wfClear"></div>'))},processActQueueItem:function(){var e=this.activityQueue.shift();e&&(jQuery("#consoleActivity").append('<div class="wfActivityLine wf'+e.type+'">['+e.date+"]&nbsp;"+e.msg+"</div>"),this.totalActAdded++,this.totalActAdded>this.maxActivityLogItems&&(jQuery("#consoleActivity div:first").remove(),this.totalActAdded--),"Scan complete."==e.msg&&this.loadIssues())},updateLiveTraffic:function(e){var t,a,n;e||!this.liveTrafficUpdatePending&&(this.windowHasFocus()||"1"!=WordfenceAdminVars.allowsPausing)?(jQuery("body").hasClass("wordfenceLiveActivityPaused")&&jQuery("body").removeClass("wordfenceLiveActivityPaused"),this.liveTrafficUpdatePending=!0,"liveTraffic"==this.mode&&(a=(t=this).newestActivityTime,n="",this.wfLiveTraffic&&(n+=this.wfLiveTraffic.getCurrentQueryString({since:this.newestActivityTime})),n+="&otherParams="+encodeURIComponent(a),this.ajax("wordfence_ticker",n,function(e){t.handleLiveTrafficReturn(e)},function(){t.liveTrafficUpdatePending=!1},!0)),this.liveTrafficUpdatePending=!1):jQuery("body").hasClass("wordfenceLiveActivityPaused")||this.liveTrafficUpdatePending||jQuery("body").addClass("wordfenceLiveActivityPaused")},handleLiveTrafficReturn:function(e){this.liveTrafficUpdatePending=!1,this.serverTimestampOffset=(new Date).getTime()/1e3-e.serverTime,this.serverMicrotime=e.serverMicrotime;var t="Idle",a=jQuery(".wf-live-activity-message").text();e.msg&&(t=e.msg),t&&t!=a&&jQuery(".wf-live-activity-message").hide().html(t).fadeIn(200),"liveTraffic"==this.mode&&(0<e.events.length&&(this.newestActivityTime=e.events[0].ctime),void 0!==_typeof(WFAD.wfLiveTraffic)&&(WFAD.wfLiveTraffic.prependListings(e.events,e),this.reverseLookupIPs(),this.avatarLookup(),this.updateTimeAgo()))},avatarLookup:function(){var n=[];if(l(".wfAvatar").each(function(e,t){var a=Number.parseInt(l(t).data("userid"));Number.isNaN(a)||l(t).data("wfAvatarDone")||(l(t).data("wfAvatarDone",!0),n.push(a))}),!(n.length<1)){for(var e={},t=[],a=0;a<n.length;a++)e[n[a]]||(e[n[a]]=!0,t.push(n[a]));this.ajax("wordfence_avatarLookup",{ids:t.join(",")},function(n){n.ok&&l(".wfAvatar").each(function(e,t){var a=Number.parseInt(l(t).data("userid"));Number.isNaN(a)||n.avatars[a]&&l(t).html(n.avatars[a])})},!1,!1)}},reverseLookupIPs:function(){var r=this,n=[];if(jQuery(".wfReverseLookup").each(function(e,t){var a=jQuery(t).text().trim();/^\d+\.\d+\.\d+\.\d+$/.test(a)&&!jQuery(t).data("wfReverseDone")&&(jQuery(t).data("wfReverseDone",!0),n.push(a))}),!(n.length<1)){for(var e={},t=[],a=0;a<n.length;a++)e[n[a]]||(e[n[a]]=!0,t.push(n[a]));this.ajax("wordfence_reverseLookup",{ips:t.join(",")},function(s){s.ok&&jQuery(".wfReverseLookup").each(function(e,t){var a,n=jQuery(t),o=n.text().trim();for(var i in s.ips){o==i&&(s.ips[i]?(a=n.attr("data-reverse-lookup-template"))?jQuery(t).html(jQuery.tmpl(l("#"+a),{ip:s.ips[i]})):n.hasClass("wf-hostname-only")?jQuery(t).text(s.ips[i]):jQuery(t).html("<strong>Hostname:</strong>&nbsp;"+r.htmlEscape(s.ips[i])):jQuery(t).html(""))}})},!1,!1)}},killScan:function(t){this.ajax("wordfence_killScan",{},function(e){e.ok?("function"==typeof t&&t(!0),WFAD.scanRunning=!1,WFAD.scanFailed=!1,l(window).trigger("wfScanUpdateButtons")):"function"==typeof t&&t(!1)})},startScan:function(){this.ajax("wordfence_scan",{},function(e){e.ok&&(WFAD.scanRunning=!0,l("#wf-scan-results-new").empty(),l("#wf-scan-bulk-buttons-delete, #wf-scan-bulk-buttons-repair").addClass("wf-disabled"),WFAD.updateIssueCounts(e.issueCounts),l(window).trigger("wfScanUpdateButtons"))})},loadIssues:function(n,e,t){var o;"scan"==this.mode&&(e=e||0,t=t||WordfenceAdminVars.scanIssuesPerPage,(o=this).ajax("wordfence_loadIssues",{offset:e,limit:t},function(e){var t=parseInt(e.issueCounts.new)||0,a=(parseInt(e.issueCounts.ignoreP)||0)+(parseInt(e.issueCounts.ignoreC)||0);jQuery("#wfNewIssuesTab .wfIssuesCount").text(" ("+t+")"),jQuery("#wfIgnoredIssuesTab .wfIssuesCount").text(" ("+a+")"),o.displayIssues(e,n)}))},loadMoreIssues:function(t,e,a,n,o){e=e||0,a=a||WordfenceAdminVars.scanIssuesPerPage,n=n||0,o=o||WordfenceAdminVars.scanIssuesPerPage,e>=WFAD.scanIssuesNewCount&&n>=WFAD.scanIssuesIgnoredCount||WFAD.ajax("wordfence_loadIssues",{offset:e,limit:a,ignoredOffset:n,ignoredLimit:o},function(e){WFAD.updateIssueCounts(e.issueCounts),WFAD.appendIssues(e.issues,t)})},sev2num:function(e){return/wfProbSev1/.test(e)?1:/wfProbSev2/.test(e)?2:0},isIssueExpanded:function(e){var t="wf-scan-issue-expanded-"+e;return!!window.localStorage&&!!parseInt(window.localStorage.getItem(t))},expandIssue:function(e,t){var a="wf-scan-issue-expanded-"+e;window.localStorage&&window.localStorage.setItem(a,t?1:0)},displayIssues:function(e,t){for(var a in e.issues){var n="wf-scan-results-"+a;l("#"+n).length<1||e.issues[a].length<1||l("#"+n).empty()}return WFAD.appendIssues(e.issues,t),!0},appendIssues:function(e,t){for(var a in e){var n="wf-scan-results-"+a;if(!(l("#"+n).length<1))for(var o=l("#"+n),i=0;i<e[a].length;i++){var s=e[a][i];WFAD.appendIssue(s,o)}}WFAD.sortIssues(),WFAD.updateBulkButtons(),"function"==typeof t&&t()},appendIssue:function(e,t){var a,n,o="issueTmpl_"+e.type,i=l("#"+o);i.length&&((a=i.tmpl(e)).data("sourceData",e),a.data("templateName",o),this.isIssueExpanded(e.id)&&a.addClass("wf-active"),a.find(".wf-issue-control-show-details").on("click",function(e){e.preventDefault(),e.stopPropagation();var t=l(this).closest(".wf-issue").hasClass("wf-active"),a=l(this).closest(".wf-issue").data("issueId");WFAD.expandIssue(a,!t),l(this).closest(".wf-issue").toggleClass("wf-active",!t)}),a.find(".wf-issue-control-ignore").each(function(){var t=l(this).closest(".wf-issue").data("issueId"),a=l(this).parent().find(".wf-issue-control-ignore-menu").menu().hide();l(this).on("click",function(e){e.preventDefault(),e.stopPropagation();var s,r=l(this).data("ignoreAction");"choice"==r?(a.show().position({my:"left top",at:"left bottom",of:this}),l(document).on("click",function(){a.hide()})):(s=this,WFAD.updateIssueStatus(t,r,function(e){var t,a,n,o,i;e.ok&&(t=l(s).closest(".wf-scan-results-issues"),(n=(a=l(s).closest(".wf-issue")).data("sourceData")).status=r,o="wf-scan-results-"+("wf-scan-results-new"==t.attr("id")?"ignored":"new"),i=l("#"+o),a.remove(),WFAD.appendIssue(n,i),WFAD.sortIssues(),WFAD.updateIssueCounts(e.issueCounts),WFAD.repositionSiteCleaningCallout(),WFAD.updateBulkButtons())}))}),a.find(".wf-issue-control-ignore-menu-ignorec").on("click",function(e){e.preventDefault(),e.stopPropagation();var s=this;WFAD.updateIssueStatus(t,"ignoreC",function(e){var t,a,n,o,i;e.ok&&(t=l(s).closest(".wf-scan-results-issues"),(n=(a=l(s).closest(".wf-issue")).data("sourceData")).status="ignoreC",o="wf-scan-results-"+("wf-scan-results-new"==t.attr("id")?"ignored":"new"),i=l("#"+o),a.remove(),WFAD.appendIssue(n,i),WFAD.sortIssues(),WFAD.updateIssueCounts(e.issueCounts),WFAD.repositionSiteCleaningCallout(),WFAD.updateBulkButtons())})}),a.find(".wf-issue-control-ignore-menu-ignorep").on("click",function(e){e.preventDefault(),e.stopPropagation();var s=this;WFAD.updateIssueStatus(t,"ignoreP",function(e){var t,a,n,o,i;e.ok&&(t=l(s).closest(".wf-scan-results-issues"),(n=(a=l(s).closest(".wf-issue")).data("sourceData")).status="ignoreP",o="wf-scan-results-"+("wf-scan-results-new"==t.attr("id")?"ignored":"new"),i=l("#"+o),a.remove(),WFAD.appendIssue(n,i),WFAD.sortIssues(),WFAD.updateIssueCounts(e.issueCounts),WFAD.repositionSiteCleaningCallout(),WFAD.updateBulkButtons())})})}),a.find(".wf-issue-control-mark-fixed").each(function(){var a=l(this).closest(".wf-issue").data("issueId");l(this).on("click",function(e){e.preventDefault(),e.stopPropagation();var t=this;WFAD.updateIssueStatus(a,"delete",function(e){e.ok&&(l(t).closest(".wf-issue").remove(),WFAD.updateIssueCounts(e.issueCounts),WFAD.repositionSiteCleaningCallout(),WFAD.updateBulkButtons())})})}),a.find(".wf-issue-control-delete-file").each(function(){var a=l(this).closest(".wf-issue").data("issueId");l(this).on("click",function(e){e.preventDefault(),e.stopPropagation();var t=this;WFAD.deleteFile(a,!1,function(e){e.ok?(l(t).closest(".wf-issue").remove(),WFAD.updateIssueCounts(e.issueCounts),WFAD.repositionSiteCleaningCallout(),WFAD.updateBulkButtons(),WFAD.colorboxModal(WFAD.isSmallScreen?"300px":"400px",u("Success deleting file"),d(u("The file %s was successfully deleted."),e.file))):e.errorMsg&&WFAD.colorboxError(e.errorMsg,e.tokenInvalid)})})}),a.find(".wf-issue-control-repair").each(function(){var t=l(this).closest(".wf-issue").data("issueId");l(this).on("click",function(e){e.preventDefault(),e.stopPropagation(),WFAD.promptToRepairFile(t,l(this).attr("data-file"))})}),a.find(".wf-issue-control-hide-file").each(function(){var a=l(this).closest(".wf-issue").data("issueId");l(this).on("click",function(e){e.preventDefault(),e.stopPropagation();var t=this;WFAD.hideFile(a,function(e){e.ok?(l(t).closest(".wf-issue").remove(),WFAD.updateIssueCounts(e.issueCounts),WFAD.repositionSiteCleaningCallout(),WFAD.updateBulkButtons(),WFAD.colorboxModal(WFAD.isSmallScreen?"300px":"400px",u("File hidden successfully"),d(u("The file %s was successfully hidden from public view."),e.file))):e.errorMsg&&WFAD.colorboxError(e.errorMsg,e.tokenInvalid)})})}),(n=l('.wf-issue[data-issue-id="'+e.id+'"]')).length?n.replaceWith(a):t.append(a),a.find(".wf-issue-summary").on("mousedown",function(e){l(this).data("clickTapX",e.pageX).data("clickTapY",e.pageY)}).on("click",function(e){var t=l(this).data("clickTapX"),a=l(this).data("clickTapY");if(t>e.pageX-10&&t<e.pageX+10&&a>e.pageY-10&&a<e.pageY+10){for(var n=l(this).find("a"),o=0;o<n.length;o++){var i=l(n[o]).offset().top,s=l(n[o]).offset().left,r=i+l(n[o]).height(),c=s+l(n[o]).width();if(e.pageX>s-10&&e.pageX<c+10&&e.pageY>i-10&&e.pageY<r+10)return}l(this).closest(".wf-issue").find("li.wf-issue-controls .wf-issue-control-show-details").trigger("click")}}).css("cursor","pointer"))},sortIssues:function(){for(var e=["new","ignored"],t=0;t<e.length;t++){var a,n,o="wf-scan-results-"+e[t];l("#"+o).length<1||((n=(a=l("#"+o)).find(".wf-issue")).detach(),n.sort(function(e,t){var a=l(e).data("issueSeverity"),n=l(t).data("issueSeverity");if(n<a)return-1;if(a<n)return 1;var o=l(e).data("issueType"),i=l(t).data("issueType"),s=WFAD.siteCleaningIssueTypes.indexOf(o),r=WFAD.siteCleaningIssueTypes.indexOf(i);return-1<s&&-1<r?s<r?-1:r<s?1:0:-1<s?-1:-1<r?1:o<i?-1:i<o?1:0}),a.append(n))}WFAD.repositionSiteCleaningCallout(),WFAD.scanIssuesOffset=l("#wf-scan-results-new .wf-issue").length,WFAD.scanIssuesIgnoredOffset=l("#wf-scan-results-ignored .wf-issue").length},updateBulkButtons:function(){var e="wf-scan-results-new";if(!(l("#"+e).length<1)){for(var t=!1,a=!1,n=l("#"+e).find(".wf-issue"),o=0;o<n.length;o++){var i=l(n[o]).data("sourceData");if(i&&(i.data.canDelete&&(t=!0),i.data.canFix&&(a=!0),t&&a))break}l("#wf-scan-bulk-buttons-delete").toggleClass("wf-disabled",!t),l("#wf-scan-bulk-buttons-repair").toggleClass("wf-disabled",!a)}},updateIssueCounts:function(e){var t,a=void 0===e.new?0:parseInt(e.new),n=(void 0===e.ignoreC?0:parseInt(e.ignoreC))+(void 0===e.ignoreP?0:parseInt(e.ignoreP));WFAD.scanIssuesNewCount=a,WFAD.scanIssuesIgnoredCount=n,WFAD.scanIssuesTotalCount=a+n,l("#wf-scan-tab-new a").html(l("#wf-scan-tab-new").data("tabTitle")+" ("+a+")"),l("#wf-scan-tab-ignored a").html(l("#wf-scan-tab-ignored").data("tabTitle")+" ("+n+")"),0==a?0==l('.wf-issue[data-issue-id="no-issues-new"]').length&&(t=l("#issueTmpl_noneFound").tmpl({shortMsg:u("No new issues have been found."),id:"no-issues-new"}),l("#wf-scan-results-new").append(t)):l('.wf-issue[data-issue-id="no-issues-new"]').remove(),0==n?0==l('.wf-issue[data-issue-id="no-issues-ignored"]').length&&(t=l("#issueTmpl_noneFound").tmpl({shortMsg:u("No issues have been ignored."),id:"no-issues-ignored"}),l("#wf-scan-results-ignored").append(t)):l('.wf-issue[data-issue-id="no-issues-ignored"]').remove()},repositionSiteCleaningCallout:function(){l(".wf-issue-site-cleaning").remove();for(var e=WFAD.siteCleaningIssueTypes,t=0;t<e.length;t++)if(l("#wf-scan-results-new .wf-issue-"+e[t]).length)return void(l("#wf-scan-results-new .wf-issue-"+e[t]).data("betaSignatures")?l("#wf-scan-results-new .wf-issue").first().after(l("#siteCleaningBetaSigsTmpl").tmpl()):l("#wf-scan-results-new .wf-issue-"+e[t]).data("highSensitivity")?l("#wf-scan-results-new .wf-issue").first().after(l("#siteCleaningHighSenseTmpl").tmpl()):l("#wf-scan-results-new .wf-issue").first().after(l("#siteCleaningTmpl").tmpl()))},ajax:function(e,t,a,n,o){"string"==typeof t?(0<t.length&&(t+="&"),t+="action="+e+"&nonce="+this.nonce):"object"==_typeof(t)&&t instanceof Array?(t.push({name:"action",value:e}),t.push({name:"nonce",value:this.nonce})):"object"==_typeof(t)&&(t.action=e,t.nonce=this.nonce),a=a||function(){},n=n||function(){};var i=this;o||this.showLoading(),jQuery.ajax({type:"POST",url:WordfenceAdminVars.ajaxURL,dataType:"json",data:t,success:function(e){o||i.removeLoading(),e&&e.nonce&&(i.nonce=e.nonce),e&&e.errorMsg&&WFAD.colorboxError(e.errorMsg,e.tokenInvalid),a(e)},error:function(){o||i.removeLoading(),n()}})},colorbox:function(e,t,a,n){void 0===n&&(n={}),this.colorboxQueue.push([e,"<h3>"+t+"</h3><p>"+a+"</p>",n]),this.colorboxServiceQueue()},colorboxModalHTML:function(e,t,a,n){void 0===n&&(n={});var o=l.tmpl(WordfenceAdminVars.modalHTMLTemplate,{title:t,message:a}),i=l("<div />").append(o).html(),s=n.onComplete;n.overlayClose=!1,n.closeButton=!1,n.className="wf-modal",n.onComplete=function(){l("#wf-generic-modal-close").on("click",function(e){e.preventDefault(),e.stopPropagation(),WFAD.colorboxClose()}),"function"==typeof s&&s()},this.colorboxHTML(e,i,n)},colorboxModal:function(e,t,a,n){void 0===n&&(n={});var o=l.tmpl(WordfenceAdminVars.modalTemplate,{title:t,message:a}),i=l("<div />").append(o).html(),s=n.onComplete;n.overlayClose=!1,n.closeButton=!1,n.className="wf-modal",n.onComplete=function(){l("#wf-generic-modal-close").on("click",function(e){e.preventDefault(),e.stopPropagation(),WFAD.colorboxClose()}),"function"==typeof s&&s()},this.colorboxHTML(e,i,n)},colorboxError:function(e,t){var a=!1;if(t){if(WFAD.tokenErrorShowing)return;a=function(){setTimeout(function(){WFAD.tokenErrorShowing=!1},3e4)},WFAD.tokenErrorShowing=!0}var n=l.tmpl(WordfenceAdminVars.tokenInvalidTemplate,{title:u("An error occurred"),message:e}),o=l("<div />").append(n).html(),i={overlayClose:!1,closeButton:!1,className:"wf-modal",onComplete:function(){l("#wf-token-invalid-modal-reload").on("click",function(e){e.preventDefault(),e.stopPropagation(),window.location.reload(!0)}),"function"==typeof a&&a()}};WFAD.colorboxHTML(WFAD.isSmallScreen?"300px":"400px",o,i)},colorboxHTML:function(e,t,a){void 0===a&&(a={}),this.colorboxQueue.push([e,t,a]),this.colorboxServiceQueue()},colorboxServiceQueue:function(){var e;this.colorboxIsOpen||this.colorboxQueue.length<1||(e=this.colorboxQueue.shift(),this.colorboxOpen(e[0],e[1],e[2]))},colorboxOpen:function(e,t,a){var n=this;this.colorboxIsOpen=!0,jQuery.extend(a,{width:e,html:t,onClosed:function(){n.colorboxClose()}}),jQuery.wfcolorbox(a)},colorboxClose:function(){this.colorboxIsOpen=!1,jQuery.wfcolorbox.close()},bulkOperationConfirmed:function(e){WFAD.colorboxClose(),this.ajax("wordfence_bulkOperation",{op:e},function(e){if(e.ok){for(var t=0;t<e.idsRemoved.length;t++)l('.wf-issue[data-issue-id="'+e.idsRemoved[t]+'"]').remove();WFAD.updateIssueCounts(e.issueCounts),WFAD.repositionSiteCleaningCallout(),WFAD.updateBulkButtons(),setTimeout(function(){WFAD.colorboxModalHTML(WFAD.isSmallScreen?"300px":"400px",e.bulkHeading,e.bulkBody)},500)}})},deleteFile:function(e,t,a){this.ajax("wordfence_deleteFile",{issueID:e,forceDelete:t},function(e){e.needsCredentials?document.location.href=e.redirect:"function"==typeof a&&a(e)})},promptToRepairFile:function(e,t){if(window.localStorage){var a=window.localStorage.getItem("wf-repair-file-sudo");if(a&&parseInt(a,10)>(new Date).getTime())return void this.repairFile(e)}WFAD.colorboxModalHTML(WFAD.isSmallScreen?"300px":"400px",u("Download Backup File"),u("Please make a backup of this file before proceeding. If you need to restore this backup file, you can copy it to the following path from your site's root:")+'<p class="wf-padding-add-top-medium"><code>'+t+'</code></p><a href="'+WFAD.makeDownloadFileLink(t)+"\" onclick=\"jQuery('#wfRepairFileNextBtn').prop('disabled', false); return true;\">"+u("Click here to download a backup copy of this file now")+'</a><p class="wf-flex-horizontal"><input type="button" class="wf-btn wf-btn-primary" name="but1" id="wfRepairFileNextBtn" value="Repair File" disabled="disabled" onclick="WFAD.promptToRepairFileDone('+parseInt(e,10)+', jQuery(\'#forceRepairFileCheckbox\').prop(\'checked\'));this.disabled=true;" /><label class="wf-padding-add-left"><input type="checkbox" id="forceRepairFileCheckbox" onclick="jQuery(\'#wfRepairFileNextBtn\').prop(\'disabled\', !this.checked); return true;"> '+u("Don't ask again")+'</label></p><div class="wordfenceHelpLink"><a href="'+WordfenceAdminVars.supportURLs["scan-result-repair-modified-files"]+'" target="_blank" rel="noopener noreferrer" class="wfhelp"></a><a href="'+WordfenceAdminVars.supportURLs["scan-result-repair-modified-files"]+'" target="_blank" rel="noopener noreferrer">'+u("Learn more about repairing modified files.")+" ("+u("opens in new tab")+")</a></div>")},promptToRepairFileDone:function(e,t){t&&window.localStorage&&window.localStorage.setItem("wf-repair-file-sudo",(new Date).getTime()+864e5),this.repairFile(e)},repairFile:function(t){var a=this;a.colorboxClose(),this.restoreFile(t,function(e){e.ok?(l(".wf-issue[data-issue-id="+parseInt(t,10)+"]").remove(),a.updateIssueCounts(e.issueCounts),a.repositionSiteCleaningCallout(),a.updateBulkButtons(),a.colorboxModal(a.isSmallScreen?"300px":"400px",u("Success restoring file"),d(u("The file %s was successfully restored."),e.file))):e.errorMsg&&a.colorboxError(e.errorMsg,e.tokenInvalid)})},deleteDatabaseOption:function(e){var t=this;this.ajax("wordfence_deleteDatabaseOption",{issueID:e},function(e){t.doneDeleteDatabaseOption(e)})},doneDeleteDatabaseOption:function(e){var t=this;e.ok?this.loadIssues(function(){t.colorboxModal(t.isSmallScreen?"300px":"400px",u("Success removing option"),d(u("The option %s was successfully removed."),e.option_name))}):e.cerrorMsg&&this.loadIssues(function(){WFAD.colorboxError(e.cerrorMsg,e.tokenInvalid)})},useRecommendedHowGetIPs:function(e){var t=this;this.ajax("wordfence_misconfiguredHowGetIPsChoice",{issueID:e,choice:"yes"},function(e){e.ok?(jQuery("#wordfenceMisconfiguredHowGetIPsNotice").fadeOut(),t.loadIssues(function(){t.colorboxModal(t.isSmallScreen?"300px":"400px",u("Success updating option"),u("The 'How does Wordfence get IPs' option was successfully updated to the recommended value."))})):e.cerrorMsg&&t.loadIssues(function(){WFAD.colorboxError(e.cerrorMsg,e.tokenInvalid)})})},fixFPD:function(t){var a=this,n=u("Full Path Disclosure");t=parseInt(t),this.ajax("wordfence_checkHtaccess",{},function(e){e.ok?a.colorboxModalHTML(a.isSmallScreen?"300px":"400px",n,u("We are about to change your <em>.htaccess</em> file. Please make a backup of this file before proceeding.")+'<br/><a href="'+WordfenceAdminVars.ajaxURL+"?action=wordfence_downloadHtaccess&nonce="+a.nonce+"\" onclick=\"jQuery('#wfFPDNextBut').prop('disabled', false); return true;\">"+u("Click here to download a backup copy of your .htaccess file now")+'</a><br /><br /><input type="button" class="wf-btn wf-btn-default" name="but1" id="wfFPDNextBut" value="Click to fix .htaccess" disabled="disabled" onclick="WFAD.fixFPD_WriteHtAccess('+t+');" />'):e.nginx?a.colorboxModalHTML(a.isSmallScreen?"300px":"400px",n,u("You are using an Nginx web server and using a FastCGI processor like PHP5-FPM. You will need to manually modify your php.ini to disable <em>display_error</em>")):e.err&&a.colorboxModal(a.isSmallScreen?"300px":"400px",u("We encountered a problem"),d(u("We can't modify your .htaccess file for you because: %s"),e.err))})},fixFPD_WriteHtAccess:function(e){var t=this;t.colorboxClose(),this.ajax("wordfence_fixFPD",{issueID:e},function(e){e.ok?t.loadIssues(function(){t.colorboxModal(t.isSmallScreen?"300px":"400px",u("File restored OK"),u("The Full Path disclosure issue has been fixed"))}):t.loadIssues(function(){WFAD.colorboxError(e.cerrorMsg,e.tokenInvalid)})})},hideFile:function(t,a){WFAD.ajax("wordfence_checkHtaccess",{},function(e){e.ok?(WFAD.colorboxModalHTML(WFAD.isSmallScreen?"300px":"400px",u(".htaccess change"),u("We are about to change your <em>.htaccess</em> file. Please make a backup of this file before proceeding.")+'<br/><a id="dlButton" href="'+WordfenceAdminVars.ajaxURL+"?action=wordfence_downloadHtaccess&nonce="+WFAD.nonce+'">'+u("Click here to download a backup copy of your .htaccess file now")+'</a><br /><br /><input type="button" class="wf-btn wf-btn-default" name="but1" id="wfFPDNextBut" value="'+u("Click to fix .htaccess")+'" disabled="disabled" />'),l("#dlButton").on("click",function(e){l("#wfFPDNextBut").prop("disabled",!1)}),l("#wfFPDNextBut").on("click",function(e){e.preventDefault(),e.stopPropagation(),WFAD.ajax("wordfence_hideFileHtaccess",{issueID:t},function(e){WFAD.colorboxClose(),"function"==typeof a&&a(e)})})):e.nginx?WFAD.colorboxModal(WFAD.isSmallScreen?"300px":"400px",u("Unable to automatically hide file"),u("You are using an Nginx web server and using a FastCGI processor like PHP5-FPM. You will need to manually delete or hide those files.")):e.err&&WFAD.colorboxModal(WFAD.isSmallScreen?"300px":"400px",u("We encountered a problem"),d(u("We can't modify your .htaccess file for you because: %s"),res.err))})},restoreFile:function(e,t){this.ajax("wordfence_restoreFile",{issueID:e},function(e){e.needsCredentials?document.location.href=e.redirect:"function"==typeof t&&t(e)})},disableDirectoryListing:function(t){var a=this;t=parseInt(t),this.ajax("wordfence_checkHtaccess",{},function(e){e.ok?a.colorboxModalHTML(a.isSmallScreen?"300px":"400px","Disable Directory Listing",u("We are about to change your <em>.htaccess</em> file. Please make a backup of this file before proceeding.")+'<br/><a href="'+WordfenceAdminVars.ajaxURL+"?action=wordfence_downloadHtaccess&nonce="+a.nonce+"\" onclick=\"jQuery('#wf-htaccess-confirm').prop('disabled', false); return true;\">"+u("Click here to download a backup copy of your .htaccess file now")+'</a><br /><br /><button class="wf-btn wf-btn-default" type="button" id="wf-htaccess-confirm" disabled="disabled" onclick="WFAD.confirmDisableDirectoryListing('+t+');">'+u("Add code to .htaccess")+"</button>"):e.nginx?a.colorboxModalHTML(a.isSmallScreen?"300px":"400px",u("You are using Nginx as your web server. You'll need to disable autoindexing in your nginx.conf. See the <a target='_blank'  rel='noopener noreferrer' href='https://nginx.org/en/docs/http/ngx_http_autoindex_module.html'>Nginx docs for more info</a> on how to do this.")):e.err&&a.colorboxModal(a.isSmallScreen?"300px":"400px",u("We encountered a problem"),d(u("We can't modify your .htaccess file for you because: %s"),e.err))})},confirmDisableDirectoryListing:function(e){var t=this;this.colorboxClose(),this.ajax("wordfence_disableDirectoryListing",{issueID:e},function(e){e.ok&&t.loadIssues(function(){t.colorboxModal(t.isSmallScreen?"300px":"400px",u("Directory Listing Disabled"),u("Directory listing has been disabled on your server."))})})},deleteIssue:function(e){var t=this;this.ajax("wordfence_deleteIssue",{id:e},function(e){t.loadIssues()})},updateIssueStatus:function(e,t,a){this.ajax("wordfence_updateIssueStatus",{id:e,status:t},function(e){"function"==typeof a&&a(e)})},es:function(e){return e||""},noQuotes:function(e){return e.replace(/"/g,"&#34;").replace(/\'/g,"&#145;")},commify:function(e){return(""+e).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},switchToLiveTab:function(e){jQuery(".wfTab1").removeClass("selected"),jQuery(e).addClass("selected"),jQuery(".wfDataPanel").hide();var t=this;jQuery("#wfActivity").fadeIn(function(){t.completeLiveTabSwitch()})},completeLiveTabSwitch:function(){this.ajax("wordfence_loadActivityLog",{},function(e){var t='<a href="#" class="wfALogMailLink" onclick="WFAD.emailActivityLog(); return false;" role="button"></a><a href="#" class="wfALogReloadLink" onclick="WFAD.reloadActivityData(); return false;" role="button"></a>';if(e.events&&0<e.events.length){jQuery("#wfActivity").empty();for(var a=0;a<e.events.length;a++){var n="0.0000";e.events[a+1]&&(n=(e.events[a].ctime-e.events[a+1].ctime).toFixed(4));var o="";"error"==e.events[a].type&&(o=' class="wfWarn" '),t+="<div "+o+'class="wfALogEntry"><span '+o+'class="wfALogTime">['+e.events[a].type+"&nbsp;:&nbsp;"+n+"&nbsp;:&nbsp;"+e.events[a].timeAgo+" ago]</span>&nbsp;"+e.events[a].msg+"</div>"}jQuery("#wfActivity").html(t)}else jQuery("#wfActivity").html("<p>&nbsp;&nbsp;"+u("No activity to report yet. Please complete your first scan.")+"</p>")})},emailActivityLog:function(){this.colorboxModalHTML(this.isSmallScreen?"300px":"400px",u("Email Wordfence Activity Log"),u("Enter the email address you would like to send the Wordfence activity log to. Note that the activity log may contain thousands of lines of data. This log is usually only sent to a member of the Wordfence support team. It also contains your PHP configuration from the phpinfo() function for diagnostic data.")+"<br /><br /><input type='text' value='wftest@wordfence.com' size='20' id='wfALogRecip' /><input class='wf-btn wf-btn-default' type='button' value='"+u("Send")+'\' onclick="WFAD.completeEmailActivityLog();" />')},completeEmailActivityLog:function(){WFAD.colorboxClose();var t,a=jQuery("#wfALogRecip").val();/^[^@]+@[^@]+$/.test(a)?(t=this).ajax("wordfence_sendActivityLog",{email:jQuery("#wfALogRecip").val()},function(e){e.ok&&t.colorboxModal(t.isSmallScreen?"300px":"400px",u("Activity Log Sent"),d(u("Your Wordfence activity log was sent to %s"),a))}):alert(u("Please enter a valid email address."))},reloadActivityData:function(){jQuery("#wfActivity").html('<div class="wfLoadingWhite32"></div>'),this.completeLiveTabSwitch()},switchToSummaryTab:function(e){jQuery(".wfTab1").removeClass("selected"),jQuery(e).addClass("selected"),jQuery(".wfDataPanel").hide(),jQuery("#wfSummaryTables").fadeIn()},switchIssuesTab:function(e,t){jQuery(".wfTab2").removeClass("selected"),jQuery(".wfIssuesContainer").hide(),jQuery(e).addClass("selected"),this.visibleIssuesPanel=t,jQuery("#wfIssues_"+t).fadeIn()},switchTab:function(e,t,a,n,o){jQuery("."+t).removeClass("selected"),jQuery(e).addClass("selected"),jQuery("."+a).hide().html('<div class="wfLoadingWhite32"></div>');var i=o?function(){o()}:function(){};jQuery("#"+n).fadeIn(i)},reloadLiveTraffic:function(){this.newestActivityTime=0,this.updateLiveTraffic(!0)},ucfirst:function(e){return(e=""+e).charAt(0).toUpperCase()+e.slice(1)},makeIPTrafLink:function(e){return WordfenceAdminVars.siteBaseURL+"?_wfsf=IPTraf&nonce="+this.nonce+"&IP="+encodeURIComponent(e)},makeDiffLink:function(e){return WordfenceAdminVars.siteBaseURL+"?_wfsf=diff&nonce="+this.nonce+"&file="+encodeURIComponent(this.es(e.file))+"&cType="+encodeURIComponent(this.es(e.cType))+"&cKey="+encodeURIComponent(this.es(e.cKey))+"&cName="+encodeURIComponent(this.es(e.cName))+"&cVersion="+encodeURIComponent(this.es(e.cVersion))},makeViewFileLink:function(e){return WordfenceAdminVars.siteBaseURL+"?_wfsf=view&nonce="+this.nonce+"&file="+encodeURIComponent(e)},makeDownloadFileLink:function(e){return WordfenceAdminVars.siteBaseURL+"?_wfsf=download&nonce="+this.nonce+"&file="+encodeURIComponent(e)},makeViewOptionLink:function(e,t){return WordfenceAdminVars.siteBaseURL+"?_wfsf=viewOption&nonce="+this.nonce+"&option="+encodeURIComponent(e)+"&site_id="+encodeURIComponent(t)},parseHashes:function(){for(var e=window.location.hash.replace("%23","#").split("#"),t=[],a=0;a<e.length;a++)0<e[a].length&&t.push(e[a]);return t},makeTimeAgo:function(e){var t=Math.floor(e/2592e3),a=Math.floor(e/86400),n=Math.floor(e/3600),o=Math.floor(e/60);return 0<t?(a-=30*t,this.pluralize(t,"month",a,"day")):0<a?(n-=24*a,this.pluralize(a,"day",n,"hour")):0<n?(o-=60*n,this.pluralize(n,"hour",o,"min")):0<o?this.pluralize(o,"minute"):Math.round(e)+" seconds"},pluralize:function(e,t,a,n){return 1!=e&&(t+="s"),1!=a&&(n+="s"),e&&a?e+" "+t+" "+a+" "+n:e+" "+t},isValidIP:function(e){if(!e)return!1;if((e=e.replace(/ /g,"")).match(/^(?:\d{1,3}(?:\.|$)){4}/)){var t=e.split(".");if(4!=t.length)return!1;for(var a=0;a<t.length;a++)if(255<parseInt(t[a]))return!1;return!!this.inet_pton(e)}if(e.match(/^((?:[\da-f]{1,4}(?::|)){0,8})(::)?((?:[\da-f]{1,4}(?::|)){0,8})$/i)){if("::"==e)return!0;var n=e.split(":").length-1,o=e.indexOf("::");if(-1<o){var i=(0==o||o==e.length-2?9:8)-n;if(0==i)return!1;for(var s="",a=0;a<i;a++)s+=":0000";e=(e=e.replace("::",s+":")).replace(/(?:^\:|\:$)/,"",e)}var r=e.split(":"),c="";for(a=0;a<r.length;a++){var l=r[a];if(4<l.length||0==l.length)return!1;l=("0000"+l).slice(-4);var d=parseInt(l.slice(0,2),16),u=parseInt(l.slice(-2),16);if(isNaN(d)||isNaN(u))return!1;c+=String.fromCharCode(d)+String.fromCharCode(u)}return 16==c.length}return!1},parseIPRange:function(e){if(!e)return!1;if((e=(e=e.replace(/ /g,"")).replace(/[\u2013-\u2015]/g,"-"))&&/^[^\-]+\-[^\-]+$/.test(e)){var t=1,a=!1,n=e.split("-"),o=this.inet_pton(n[0]),i=this.inet_pton(n[1]);if(!1===o||!this.isValidIP(n[0])||!1===i||!this.isValidIP(n[1]))return!1;for(var s=("\0\0\0\0\0\0\0\0\0\0ÿÿ"+o).slice(-16),r=("\0\0\0\0\0\0\0\0\0\0ÿÿ"+i).slice(-16),c=0;c<s.length;c++){var l=s.charCodeAt(c),d=r.charCodeAt(c);if(c<11&&0<d-l){a=!0;break}if(c<11&&d-l<0)return!1;if((t+=d-l<<8*(15-c))<1)return!1}return{start:o,end:i,count:t,countOverflow:a}}if(e&&/^[^\/]+\/\d+$/.test(e)){var t=1,a=!1,u=e.split("/"),f=this.inet_pton(u[0]),p=parseInt(u[1]);if(!1===f||!this.isValidIP(u[0]))return!1;if("\0\0\0\0\0\0\0\0\0\0ÿÿ"===("\0\0\0\0\0\0\0\0\0\0ÿÿ"+f).slice(-16).slice(12)){if(p<1||32<p)return!1}else if(p<1||128<p)return!1;return{ip:f,bits:p,count:t=53<=p?(a=!0,Math.pow(2,53)-1):Math.pow(2,p),countOverflow:a}}return!1},calcRangeTotal:function(){var e=jQuery("#ipRange").val();if(e)if((e=(e=e.replace(/ /g,"")).replace(/[\u2013-\u2015]/g,"-"))&&/^[^\-]+\-[^\-]+$/.test(e)){var t=1,a=!1,n=!1,o=!1,i=e.split("-"),s=this.inet_pton(i[0]),r=this.inet_pton(i[1]);if(!1===s||!1===r)o=!0;else for(var c=("\0\0\0\0\0\0\0\0\0\0ÿÿ"+s).slice(-16),l=("\0\0\0\0\0\0\0\0\0\0ÿÿ"+r).slice(-16),d=0;d<c.length;d++){var u=c.charCodeAt(d),f=l.charCodeAt(d);if(d<11&&0<f-u){a=!0;break}if(d<11&&f-u<0){n=!0;break}if((t+=f-u<<8*(15-d))<1){n=!0;break}}if(o)return void jQuery("#wfShowRangeTotal").html('<span style="color: #F00;">Invalid IP entered.</span>');if(n)return void jQuery("#wfShowRangeTotal").html('<span style="color: #F00;">Invalid. Starting IP is greater than ending IP.</span>');if(a)return void jQuery("#wfShowRangeTotal").html('<span style="color: #0A0;">Valid: &gt;281474976710656 addresses in range.</span>');jQuery("#wfShowRangeTotal").html('<span style="color: #0A0;">Valid: '+t+" addresses in range.</span>")}else jQuery("#wfShowRangeTotal").empty()},whois:function(e){var t;e=e.replace(" ",""),/\w+/.test(e)?(t=this,jQuery("#whoisbutton").attr("disabled","disabled"),jQuery("#whoisbutton").attr("value",u("Loading...")),this.ajax("wordfence_whois",{val:e},function(e){jQuery("#whoisbutton").removeAttr("disabled"),jQuery("#whoisbutton").attr("value",u("Look up IP or Domain")),e.ok&&t.completeWhois(e)})):this.colorboxModal("300px",u("Enter a valid IP or domain"),u("Please enter a valid IP address or domain name for your whois lookup."))},completeWhois:function(e,t){t=void 0!==t&&!!t;var m=this,a="",v=jQuery('<div><div class=\'wf-flex-row\'><a class="wf-btn wf-btn-default wf-flex-row-0" href="${adminUrl}">'+u("Block This Network")+"</a><span class='wf-flex-row-1 wf-padding-add-left'>{{html totalStr}}{{if totalStr.indexOf(ipRange) == -1}} (${ipRange}){{/if}}{{if (totalIPs)}}<br>["+u("${totalIPs} addresses in this network")+"]{{/if}}</span></div></div>");if(e.ok&&e.result&&e.result.rawdata&&0<e.result.rawdata.length){for(var n=0;n<e.result.rawdata.length;n++){e.result.rawdata[n]=jQuery("<div />").text(e.result.rawdata[n]).html(),e.result.rawdata[n]=e.result.rawdata[n].replace(/([a-zA-Z0-9\-._+]+@[a-zA-Z0-9\-._]+)/,'<a href="mailto:$1">$1</a>'),e.result.rawdata[n]=e.result.rawdata[n].replace(/(https?:\/\/[a-zA-Z0-9\-._+\/?&=#%:@;]+)/,'<a target="_blank" rel="noopener noreferrer" href="$1">$1</a>');var o=/(.*?)(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3} - \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|[a-f0-9:.]{3,} - [a-f0-9:.]{3,}).*$/i,i=/(.*?)(\d{1,3})\.(\d{1,3})\.?(\d{0,3})\.?(\d{0,3})\/(\d{1,3}).*$/i;o.test(e.result.rawdata[n])?(e.result.rawdata[n]=e.result.rawdata[n].replace(o,function(e,t,a,n,o){var i,s=a.split(/\s*\-\s*/),r=NaN;s[0].indexOf(":")<0&&(i=m.inet_aton(s[0]),r=m.inet_aton(s[1])-i+1);var c="admin.php?page=WordfenceWAF&wfBlockRange="+encodeURIComponent(a)+"#top#blocking";return jQuery(v).tmpl({adminUrl:c,totalStr:o,ipRange:a,totalIPs:r}).wrapAll("<div>").parent().html()}),a+=e.result.rawdata[n]):i.test(e.result.rawdata[n])?(e.result.rawdata[n]=e.result.rawdata[n].replace(i,function(e,t,a,n,o,i,s,r,c){var l=[a,n,o=0<o.length?o:"0",i=0<i.length?i:"0"].join("."),d=m.inet_aton(l);if(s=parseInt(s,10),!isNaN(d)&&0<s&&s<32){for(var u=d,f=32,p=1;s<=f;f--,p*=2)u|=p;u>>>=0;var h=m.inet_ntoa(d)+" - "+m.inet_ntoa(u),w=u-d+1,g="admin.php?page=WordfenceWAF&wfBlockRange="+encodeURIComponent(h)+"#top#blocking";return jQuery(v).tmpl({adminUrl:g,totalStr:c,ipRange:h,totalIPs:w}).wrapAll("<div>").parent().html()}return e}),a+=e.result.rawdata[n]):a+=e.result.rawdata[n]+"<br />"}if(a=a.replace(/<\/div><br \/>/g,"</div>"),t)return a;jQuery("#wfrawhtml").html(a)}else{if(a='<span style="color: #F00;">'+u("Sorry, but no data for that IP or domain was found.")+"</span>",t)return a;jQuery("#wfrawhtml").html(a)}},blockIPUARange:function(e,t,a,n,o){if(/\w+/.test(o)){if(e=(e=e.replace(/ /g,"").toLowerCase()).replace(/[\u2013-\u2015]/g,"-")){var i,s=e.split("-");if(2!==s.length?i=!1:s[0].match(":")?i=!1!==this.inet_pton(s[0])&&!1!==this.inet_pton(s[1]):s[0].match(".")&&(i=!1!==this.inet_aton(s[0])&&!1!==this.inet_aton(s[1])),!i)return void this.colorboxModal("300px",u("Specify a valid IP range"),u('Please specify a valid IP address range in the form of "1.2.3.4 - 1.2.3.5" without quotes. Make sure the dash between the IP addresses in a normal dash (a minus sign on your keyboard) and not another character that looks like a dash.'))}var r;!t||/^[a-z0-9\.\*\-]+$/i.test(t)?/\w+/.test(e)||/\w+/.test(a)||/\w+/.test(n)||/\w+/.test(t)?(r=this).ajax("wordfence_blockIPUARange",{ipRange:e,hostname:t,uaRange:a,referer:n,reason:o},function(e){e.ok&&r.loadBlockRanges()}):this.colorboxModal("300px",u("Specify an IP range, Hostname or Browser pattern"),u("Please specify either an IP address range, Hostname or a web browser pattern to match.")):this.colorboxModalHTML("300px",u("Specify a valid hostname"),d(u("%s is not valid hostname"),"<i>"+this.htmlEscape(t)+"</i>"))}else this.colorboxModal("300px",u("Please specify a reason"),u("You forgot to include a reason you're blocking this IP range. We ask you to include this for your own record keeping."))},blockIP:function(e,t,a){var n=this;this.ajax("wordfence_blockIP",{IP:e,reason:t},function(e){e.errorMsg||(n.reloadLiveTraffic(),"function"==typeof a&&a())})},unlockOutIP:function(e){var t=this;this.ajax("wordfence_unlockOutIP",{IP:e},function(e){t.staticTabChanged()})},unblockIP:function(e,t){var a=this;this.ajax("wordfence_unblockIP",{IP:e},function(e){a.reloadLiveTraffic(),"function"==typeof t&&t()})},unblockNetwork:function(e){var t=this;this.ajax("wordfence_unblockRange",{id:e},function(e){t.reloadLiveTraffic()})},unblockIPTwo:function(e){var t=this;this.ajax("wordfence_unblockIP",{IP:e},function(e){t.staticTabChanged()})},permBlockIP:function(e){var t=this;this.ajax("wordfence_permBlockIP",{IP:e},function(e){t.staticTabChanged()})},makeElemID:function(){return"wfElemGen"+this.elementGeneratorIter++},pulse:function(e){jQuery(e).fadeIn(function(){setTimeout(function(){jQuery(e).fadeOut()},2e3)})},twoFacStatus:function(e){this.colorboxModal("300px",u("Two Factor Status"),e)},addTwoFactor:function(e,t,c){var l=this;this.ajax("wordfence_addTwoFactor",{username:e,phone:t,mode:c},function(t){if(t.ok){if("authenticator"==c){var e="otpauth://totp/"+encodeURI(t.homeurl)+encodeURI(" ("+t.username+")")+"?"+t.uriQueryString+"&issuer=Wordfence",a=u("Scan the code below with your authenticator app to add this account. Some authenticator apps also allow you to type in the text version instead.")+'<br><div id="wfTwoFactorQRCodeTable"></div><br><strong>'+u("Key:")+'</strong> <input type="text"'+(l.isSmallScreen?"":' size="45"')+' value="'+t.base32Secret+'" onclick="this.select();" readonly>';if(0<t.recoveryCodes.length){a=a+"<br><br><strong>"+u("Recovery Codes")+"</strong><br><p>"+d(u("Use one of these %s codes to log in if you lose access to your authenticator device. Codes are 16 characters long, plus optional spaces. Each one may be used only once."),t.recoveryCodes.length)+'</p><ul id="wfTwoFactorRecoveryCodes">',i=(i=u("Cellphone Sign-In Recovery Codes")+" - "+t.homeurl+" ("+t.username+")\r\n")+"\r\n"+u('Each line of 16 letters and numbers is a single recovery code, with optional spaces for readability. When typing your password, enter "wf" followed by the entire code like "mypassword wf1234 5678 90AB CDEF". If your site shows a separate prompt for entering a code after entering only your username and password, enter only the code like "1234 5678 90AB CDEF". Your recovery codes are:')+"\r\n\r\n";for(var n=/.{4}/g,o=0;o<t.recoveryCodes.length;o++){a=a+"<li>"+(s=t.recoveryCodes[o].match(n))[0]+" "+s[1]+" "+s[2]+" "+s[3]+"</li>",i=i+s[0]+" "+s[1]+" "+s[2]+" "+s[3]+"\r\n"}a=(a+="</ul>")+'<p class="wf-center"><a href="#" class="wf-btn wf-btn-default" id="wfTwoFactorDownload" target="_blank" rel="noopener noreferrer"><i class="dashicons dashicons-download"></i> '+u("Download")+"</a></p>"}a=a+"<p><em>"+u("This will be shown only once. Keep these codes somewhere safe.")+"</em></p>",l.colorboxModalHTML(l.isSmallScreen?"300px":"440px",u("Authentication Code"),a,{onComplete:function(){jQuery("#wfTwoFactorQRCodeTable").qrcode({text:e,width:l.isSmallScreen?175:256,height:l.isSmallScreen?175:256}),jQuery("#wfTwoFactorDownload").on("click",function(e){e.preventDefault(),e.stopPropagation(),saveAs(new Blob([i],{type:"text/plain;charset="+document.characterSet}),l.htmlEscape(t.homeurl)+"_"+l.htmlEscape(t.username)+"_recoverycodes.txt")})}})}else if(0<t.recoveryCodes.length){var i,a="<p>"+d(u("Use one of these %s codes to log in if you are unable to access your phone. Codes are 16 characters long, plus optional spaces. Each one may be used only once."),t.recoveryCodes.length)+'</p><ul id="wfTwoFactorRecoveryCodes">';i=(i=u("Cellphone Sign-In Recovery Codes")+" - "+t.homeurl+" ("+t.username+")\r\n")+"\r\n"+u('Each line of 16 letters and numbers is a single recovery code, with optional spaces for readability. When typing your password, enter "wf" followed by the entire code like "mypassword wf1234 5678 90AB CDEF". If your site shows a separate prompt for entering a code after entering only your username and password, enter only the code like "1234 5678 90AB CDEF". Your recovery codes are:')+"\r\n\r\n";for(var s,n=/.{4}/g,o=0;o<t.recoveryCodes.length;o++){a=a+"<li>"+(s=t.recoveryCodes[o].match(n))[0]+" "+s[1]+" "+s[2]+" "+s[3]+"</li>",i=i+s[0]+" "+s[1]+" "+s[2]+" "+s[3]+"\r\n"}a=(a=a+'<p class="wf-center"><a href="#" class="wf-btn wf-btn-default" id="wfTwoFactorDownload" target="_blank" rel="noopener noreferrer"><i class="dashicons dashicons-download"></i> '+u("Download")+"</a></p>")+"</ul><p><em>"+u("This will be shown only once. Keep these codes somewhere safe.")+"</em></p>",l.colorboxModalHTML(l.isSmallScreen?"300px":"400px",u("Recovery Codes"),a,{onComplete:function(){jQuery("#wfTwoFactorDownload").on("click",function(e){e.preventDefault(),e.stopPropagation(),saveAs(new Blob([i],{type:"text/plain;charset="+document.characterSet}),l.htmlEscape(t.homeurl)+"_"+l.htmlEscape(t.username)+"_recoverycodes.txt")})}})}var r=jQuery("#wfTwoFacUserTmpl").tmpl({users:[t]});jQuery("#twoFactorUser-none").remove(),jQuery("#wfTwoFacUsers > table > tbody:last-child").append(r.find("tbody > tr"))}})},twoFacActivate:function(e,t){var a=this;this.ajax("wordfence_twoFacActivate",{userID:e,code:t},function(e){e.ok&&(jQuery("#wfTwoFacUserTmpl").tmpl({users:[e]}).find("tbody > tr").each(function(e,t){jQuery("#"+jQuery(t).attr("id")).replaceWith(t)}),a.twoFacStatus(u("Cellphone Sign-in activated for user.")))})},delTwoFac:function(e){this.ajax("wordfence_twoFacDel",{userID:e},function(e){e.ok&&jQuery("#twoFactorUser-"+e.userID).fadeOut(function(){jQuery(this).remove(),0==jQuery("#wfTwoFacUsers > table > tbody:last-child").children().length&&jQuery("#wfTwoFacUsers").html(jQuery("#wfTwoFacUserTmpl").tmpl({users:[]}))})})},loadTwoFactor:function(){this.ajax("wordfence_loadTwoFactor",{},function(e){jQuery("#wfTwoFacUsers").html(jQuery("#wfTwoFacUserTmpl").tmpl(e))})},getQueryParam:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.search);return null==t?"":decodeURIComponent(t[1].replace(/\+/g," "))},inet_aton:function(e){var t=e.split(".");return 256*(256*(256*t[0]+ +t[1])+ +t[2])+ +t[3]},inet_ntoa:function(e){for(var t=e%256,a=3;0<a;a--)t=(e=Math.floor(e/256))%256+"."+t;return t},inet_pton:function(e){var t,a=String.fromCharCode,n=e.match(/^(?:\d{1,3}(?:\.|$)){4}/);if(n)return 4===(n=a((n=n[0].split("."))[0])+a(n[1])+a(n[2])+a(n[3])).length&&n;if(t=/^((?:[\da-f]{1,4}(?::|)){0,8})(::)?((?:[\da-f]{1,4}(?::|)){0,8})$/i,n=e.match(t)){if("::"==e)return"\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0";var o=e.split(":").length-1,i=e.indexOf("::");if(-1<i){for(var s=(0==i||i==e.length-2?9:8)-o,r="",c=0;c<s;c++)r+=":0000";e=(e=e.replace("::",r+":")).replace(/(?:^\:|\:$)/,"",e)}var l=e.split(":"),d="";for(c=0;c<l.length;c++){var u=l[c];if(4<u.length)return!1;u=("0000"+u).slice(-4);var f=parseInt(u.slice(0,2),16),p=parseInt(u.slice(-2),16);if(isNaN(f)||isNaN(p))return!1;d+=a(f)+a(p)}return 16==d.length&&d}return!1},inet_ntop:function(e){var t=0,a="",n=[];if(4===(e+="").length)return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)].join(".");if(16!==e.length)return!1;for(t=0;t<16;t++)n.push(((e.charCodeAt(t++)<<8)+e.charCodeAt(t)).toString(16));return n.join(":").replace(/((^|:)0(?=:|$))+:?/g,function(e){return a=e.length>a.length?e:a,e}).replace(a||" ","::")},deleteAdminUser:function(e){var t=this;this.ajax("wordfence_deleteAdminUser",{issueID:e},function(e){e.ok?t.loadIssues(function(){t.colorboxModal(t.isSmallScreen?"300px":"400px",u("Successfully deleted admin"),d(u("The admin user %s was successfully deleted."),e.user_login))}):e.errorMsg&&t.loadIssues(function(){WFAD.colorboxError(e.errorMsg,e.tokenInvalid)})})},revokeAdminUser:function(e){var t=this;this.ajax("wordfence_revokeAdminUser",{issueID:e},function(e){e.ok?t.loadIssues(function(){t.colorboxModal(t.isSmallScreen?"300px":"400px",u("Successfully revoked admin"),d(u("All capabilties of admin user %s were successfully revoked."),e.user_login))}):e.errorMsg&&t.loadIssues(function(){WFAD.colorboxError(e.errorMsg,e.tokenInvalid)})})},windowHasFocus:function(){return"function"==typeof document.hasFocus?document.hasFocus():this._windowHasFocus},htmlEscape:function(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},permanentlyBlockAllIPs:function(e){this.ajax("wordfence_permanentlyBlockAllIPs",{type:e},function(e){l("#wfTabs").find(".wfTab1").eq(0).trigger("click")})},showTimestamp:function(e,t,a){t=void 0===t?(new Date).getTime()/1e3:t,a=void 0===a?"${dateTime} (${timeAgo} ago)":a;var n=new Date(1e3*e);return jQuery.tmpl(a,{dateTime:n.toLocaleDateString()+" "+n.toLocaleTimeString(),timeAgo:this.makeTimeAgo(t-e)})},updateTimeAgo:function(){var c=this;jQuery(".wfTimeAgo-timestamp").each(function(e,t){var a=jQuery(t),n=a;"function"==typeof jQuery&&n instanceof jQuery&&(n=n[0]);var o,i,s,r=n.getBoundingClientRect();0<=r.top&&0<=r.left&&r.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&r.right<=(window.innerWidth||document.documentElement.clientWidth)&&(o=(o=a.data("wfctime"))||a.attr("data-timestamp"),i=c.serverMicrotime,s=(s=a.data("wfformat"))||a.attr("data-format"),a.html(c.showTimestamp(o,i,s)))})},wafData:{whitelistedURLParams:[]},restoreWAFData:{whitelistedURLParams:[]},wafWhitelistedBulkChangeEnabled:function(t){l(".wf-whitelist-table-bulk-checkbox.wf-option-checkbox.wf-checked").each(function(){l(this).closest("tr").find(".wf-whitelist-item-enabled.wf-option-checkbox").each(function(){var e;!(l(this).hasClass("wf-checked")&&!t||!l(this).hasClass("wf-checked")&&t)||(e=l(this).closest("tr")).is(":visible")&&WFAD.wafWhitelistedChangeEnabled(e.data("key"),t)})})},wafWhitelistedChangeEnabled:function(e,t){l('#waf-whitelisted-urls-wrapper .whitelist-table > tbody > tr[data-key="'+e+'"]').each(function(){!!l(this).data("adding")?WFAD.pendingChanges.whitelistedURLParams.add[e].data.disabled=t?0:1:(WFAD.pendingChanges.whitelistedURLParams instanceof Object||(WFAD.pendingChanges.whitelistedURLParams={}),WFAD.pendingChanges.whitelistedURLParams.enabled instanceof Object||(WFAD.pendingChanges.whitelistedURLParams.enabled={}),WFAD.pendingChanges.whitelistedURLParams.enabled[e]=t?1:0),l(this).find(".wf-whitelist-item-enabled.wf-option-checkbox").toggleClass("wf-checked",!!t)})},wafWhitelistedBulkDelete:function(){l(".wf-whitelist-table-bulk-checkbox.wf-option-checkbox.wf-checked").each(function(){l(this).closest("tr").find(".wf-whitelist-item-enabled.wf-option-checkbox").each(function(){var e=l(this).closest("tr");e.is(":visible")&&WFAD.wafWhitelistedDelete(e.data("key"))})})},wafWhitelistedDelete:function(t){l('#waf-whitelisted-urls-wrapper .whitelist-table > tbody > tr[data-key="'+t+'"]').each(function(){!!l(this).data("adding")?delete WFAD.pendingChanges.whitelistedURLParams.add[t]:(WFAD.pendingChanges.whitelistedURLParams instanceof Object||(WFAD.pendingChanges.whitelistedURLParams={}),WFAD.pendingChanges.whitelistedURLParams.delete instanceof Object||(WFAD.pendingChanges.whitelistedURLParams.delete={}),WFAD.pendingChanges.whitelistedURLParams.delete[t]=1);for(var e=0;e<WFAD.wafData.whitelistedURLParams.length;e++){if(WFAD.wafData.whitelistedURLParams[e].path+"|"+WFAD.wafData.whitelistedURLParams[e].paramKey==t){WFAD.wafData.whitelistedURLParams.splice(e,1);break}}})},wafConfigPageRender:function(){WFAD.wafData.ruleCount=0,WFAD.wafData.rules&&(WFAD.wafData.ruleCount=Object.keys(WFAD.wafData.rules).length);var e=l("#waf-whitelisted-urls-tmpl").tmpl(WFAD.wafData);l("#waf-whitelisted-urls-wrapper").html(e);var t,a=l("#waf-rules-tmpl").tmpl(WFAD.wafData);l("#waf-rules-wrapper").html(a),l("#waf-show-all-rules-button").on("click",function(e){e.preventDefault(),e.stopPropagation(),l("#waf-rules-wrapper").addClass("wf-show-all")}),WFAD.wafData.rulesLastUpdated&&(t=new Date(1e3*WFAD.wafData.rulesLastUpdated),WFAD.renderWAFRulesLastUpdated(t)),l(window).trigger("wordfenceWAFConfigPageRender")},renderWAFRulesLastUpdated:function(e){var t=e.toString();e.toLocaleString&&(t=e.toLocaleString()),l("#waf-rules-last-updated").text(d(u("Last Updated: %s"),t)).css({opacity:0}).animate({opacity:1},500)},renderWAFRulesNextUpdate:function(e){var t=e.toString();e.toLocaleString&&(t=e.toLocaleString()),l("#waf-rules-next-update").text(d(u("Next Update Check: %s"),t)).css({opacity:0}).animate({opacity:1},500)},wafUpdateRules:function(t){var a=this;this.ajax("wordfence_updateWAFRules",{},function(e){if(a.wafData=e,a.restoreWAFData.rules=e.rules,a.restoreWAFData.rulesLastUpdated=e.rulesLastUpdated,a.wafConfigPageRender(),a.wafData.updated?a.wafData.isPaid?a.colorboxModal(a.isSmallScreen?"300px":"400px",u("Rules Updated"),u("Your rules have been updated successfully.")):a.colorboxModalHTML(a.isSmallScreen?"300px":"400px",u("Rules Updated"),u('Your rules have been updated successfully. You are currently using the free version of Wordfence. Upgrade to Wordfence premium to have your rules updated automatically as new threats emerge. <a href="https://www.wordfence.com/wafUpdateRules1/wordfence-signup/">Click here to purchase a premium license</a>. <em>Note: Your rules will still update every 30 days as a free user.</em>')):"ratelimit"==a.wafData.failure?a.colorboxModal(a.isSmallScreen?"300px":"400px",u("Rule Update Failed"),u("No rules were updated. Your website has reached the maximum number of rule update requests. Please try again later.")):"unreachable"==a.wafData.failure?a.colorboxModal(a.isSmallScreen?"300px":"400px",u("Rule Update Failed"),u("No rules were updated. Please verify your website can reach the Wordfence servers.")):a.colorboxModal(a.isSmallScreen?"300px":"400px",u("Rule Update Failed"),u("No rules were updated. Please verify you have permissions to write to the /wp-content/wflogs directory.")),"function"==typeof t)return t.apply(this,arguments)})},dateFormat:function(e){return e instanceof Date?e.toLocaleString?e.toLocaleString():e.toString():e},confirmWAFConfigureAutoPrepend:function(){var t=this;this.ajax("wordfence_wafConfigureAutoPrepend",{},function(e){t.colorboxModal(t.isSmallScreen?"300px":"400px",u(".htaccess Updated"),u("Your .htaccess has been updated successfully. Please verify your site is functioning normally."))})},updatePendingChanges:function(){l(window).off("beforeunload",WFAD._unsavedOptionsHandler),Object.keys(WFAD.pendingChanges).length?(l("#wf-cancel-changes").removeClass("wf-disabled"),l("#wf-save-changes").removeClass("wf-disabled"),l(window).on("beforeunload",WFAD._unsavedOptionsHandler)):(l("#wf-cancel-changes").addClass("wf-disabled"),l("#wf-save-changes").addClass("wf-disabled"))},_unsavedOptionsHandler:function(e){var t=u("You have unsaved changes to your options. If you leave this page, those changes will be lost.");return(e=e||window.event)&&(e.returnValue=t),t},setOption:function(e,t,a,n){var o={};o[e]=t,this.ajax("wordfence_saveOptions",{changes:JSON.stringify(o),page:WFAD.getParameterByName("page")},function(e){e.success?"function"==typeof a&&a(e):(WFAD.colorboxModal(self.isSmallScreen?"300px":"400px",u("Error Saving Option"),e.error),"function"==typeof n&&n(e))})},saveOptions:function(t){var a;Object.keys(WFAD.pendingChanges).length&&(a=this).ajax("wordfence_saveOptions",{changes:JSON.stringify(WFAD.pendingChanges),page:WFAD.getParameterByName("page")},function(e){e.success?"function"==typeof t&&t(e):WFAD.colorboxModal(a.isSmallScreen?"300px":"400px",u("Error Saving Options"),e.error)})},enableAllOptionsPage:function(){this.ajax("wordfence_enableAllOptionsPage",{},function(e){e.redirect?window.location.href=e.redirect:WFAD.colorboxModal(self.isSmallScreen?"300px":"400px",u("Error Enabling All Options Page"),e.error)})},getParameterByName:function(e,t){t=t||window.location.href,e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null},base64_decode:function(e){for(var t,a,n={},o=0,i=0,s="",r=String.fromCharCode,c=e.length,l=0;l<64;l++)n["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(l)]=l;for(t=0;t<c;t++)for(o=(o<<6)+n[e.charAt(t)],i+=6;8<=i;)((a=o>>>(i-=8)&255)||t<c-2)&&(s+=r(a));return s},base64_encode:function(e){for(var t,a,n,o,i,s,r,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="",d=0;d<e.length;)o=(t=e.charCodeAt(d++))>>2,i=(3&t)<<4|(a=e.charCodeAt(d++))>>4,s=(15&a)<<2|(n=e.charCodeAt(d++))>>6,r=63&n,isNaN(a)?s=r=64:isNaN(n)&&(r=64),l=l+c.charAt(o)+c.charAt(i)+c.charAt(s)+c.charAt(r);return l}},window.WFAD=window.wordfenceAdmin,setInterval(function(){WFAD.updateTimeAgo()},1e3)),u=window.wfi18n.__,d=window.wfi18n.sprintf,jQuery(function(){wordfenceAdmin.init(),jQuery(window).on("focus",function(){jQuery("body").hasClass("wordfenceLiveActivityPaused")&&jQuery("body").removeClass("wordfenceLiveActivityPaused")})}),l(function(){l("#wf-mobile-controls").on("click",function(e){e.preventDefault(),e.stopPropagation(),l.wfMobileMenu({menuItems:[{title:u("Save Changes"),primary:!0,disabled:l("#wf-save-changes").hasClass("wf-disabled"),action:function(){l("#wf-save-changes").trigger("click")}},{title:u("Cancel Changes"),primary:!1,disabled:l("#wf-cancel-changes").hasClass("wf-disabled"),action:function(){l("#wf-cancel-changes").trigger("click")}},{title:u("Restore Defaults"),primary:!1,disabled:l("#wf-restore-defaults").hasClass("wf-disabled"),action:function(){l("#wf-restore-defaults").trigger("click")}}]})}),l("#wf-restore-defaults").on("click",function(e){e.preventDefault(),e.stopPropagation();var t=l(this).data("restoreDefaultsSection"),a=l("#wfTmpl_restoreDefaultsPrompt").tmpl(),n=l("<div />").append(a).html();WFAD.colorboxHTML(WFAD.isSmallScreen?"300px":"400px",n,{overlayClose:!1,closeButton:!1,className:"wf-modal",onComplete:function(){l("#wf-restore-defaults-prompt-cancel").on("click",function(e){e.preventDefault(),e.stopPropagation(),WFAD.colorboxClose()}),l("#wf-restore-defaults-prompt-confirm").on("click",function(e){e.preventDefault(),e.stopPropagation(),WFAD.ajax("wordfence_restoreDefaults",{section:t},function(e){e.success?window.location.reload(!0):(WFAD.colorboxClose(),WFAD.colorboxModal(WFAD.isSmallScreen?"300px":"400px",u("Error Restoring Defaults"),e.error))})})}})}),l("#wf-save-changes").on("click",function(e){e.preventDefault(),e.stopPropagation(),WFAD.saveOptions(function(e){WFAD.pendingChanges={},WFAD.updatePendingChanges(),e.redirect?window.location.href=e.redirect:window.location.reload(!0)})}),l("#wf-cancel-changes").on("click",function(e){e.preventDefault(),e.stopPropagation(),WFAD.pendingChanges={},WFAD.updatePendingChanges(),l(".wf-option.wf-option-toggled").each(function(){var e=l(this).data("enabledValue");l(this).data("disabledValue");e==l(this).data("originalValue")?l(this).find(".wf-option-checkbox").addClass("wf-checked").attr("aria-checked","true"):l(this).find(".wf-option-checkbox").removeClass("wf-checked").attr("aria-checked","false"),l(this).trigger("change",[!0])}),l(".wf-option-toggled-boolean-switch").each(function(){var e=l(this).data("enabledValue");l(this).data("disabledValue");e==l(this).data("originalValue")?l(this).find(".wf-boolean-switch").addClass("wf-active").attr("aria-checked","true"):l(this).find(".wf-boolean-switch").removeClass("wf-active").attr("aria-checked","false"),l(this).trigger("change",[!0])}),l(".wf-option.wf-option-toggled-segmented").each(function(){var e=l(this).data("originalValue");l(this).find("[type=radio]").each(function(){if(this.value==e)return!(this.checked=!0)}),l(this).trigger("change",[!0])}),l(".wf-option.wf-option-toggled-multiple").each(function(){l(this).find(".wf-option-checkboxes > ul").each(function(){var e=l(this).data("enabledValue");l(this).data("disabledValue");e==l(this).data("originalValue")?l(this).find(".wf-option-checkbox").addClass("wf-checked").attr("aria-checked","true"):l(this).find(".wf-option-checkbox").removeClass("wf-checked").attr("aria-checked","false")}),l(this).trigger("change",[!0])}),l(".wf-option.wf-option-toggled-select").each(function(){var e=l(this).find(".wf-option-select select"),t=l(this).data("enabledToggleValue");l(this).data("disabledToggleValue");t==l(this).data("originalToggleValue")?(l(this).find(".wf-option-checkbox").addClass("wf-checked").attr("aria-checked","true"),e.attr("disabled",!1)):(l(this).find(".wf-option-checkbox").removeClass("wf-checked").attr("aria-checked","false"),e.attr("disabled",!0));var a=l(this).data("originalSelectValue");l(this).find(".wf-option-select select").val(a).trigger("change"),l(this).trigger("change",[!0])}),l(".wf-option.wf-option-select").each(function(){var e=l(this).data("originalSelectValue");l(this).find(".wf-option-select select").val(e).trigger("change"),l(this).trigger("change",[!0])}),l(".wf-option.wf-option-text").each(function(){var e=l(this).data("originalTextValue");void 0!==e&&l(this).find(".wf-option-text input").val(e),l(this).trigger("change",[!0])}),l(".wf-option.wf-option-textarea").each(function(){var e=l(this).data("originalTextValue");l(this).find(".wf-option-textarea textarea").val(e),l(this).trigger("change",[!0])}),l(".wf-option.wf-option-token").each(function(){var e=l(this).data("originalTokenValue");l(this).find("select").val(e).trigger("change"),l(this).trigger("change",[!0])}),l(".wf-option.wf-option-switch").each(function(){var e=l(this).data("originalValue");l(this).find(".wf-switch > li").each(function(){l(this).toggleClass("wf-active",e==l(this).data("optionValue")).attr("aria-checked",e==l(this).data("optionValue")?"true":"false")}),l(this).trigger("change",[!0])}),l(window).trigger("wfOptionsReset")});var e=l(".wf-select2");e.length&&l.fn.wfselect2&&e.wfselect2({minimumResultsForSearch:5}),l.fn.tooltip&&l(".wf-status-circular").each(function(){var e=l(this),t="tooltip-"+this.id+"-tmpl",a=l("#"+t);a.length&&e.tooltip({tooltipClass:"wf-circle-tooltip",position:{my:"left-40 bottom",at:"center top",using:function(e,t){l(this).removeClass("wf-tooltip-vertical-top wf-tooltip-vertical-bottom wf-tooltip-horizontal-left wf-tooltip-horizontal-right").addClass("wf-tooltip-vertical-"+t.vertical).addClass("wf-tooltip-horizontal-"+t.horizontal),l(this).css({left:e.left+"px",top:e.top+"px"})}},items:this,close:function(e,t){t.tooltip.hover(function(){l(this).stop(!0).fadeTo(400,1)},function(){l(this).fadeOut("400",function(){l(this).remove()})})},content:function(){var e=l(this).clone();e.find("svg, .wf-status-circular-text").css("opacity",1);var t=l(e).html();return a.tmpl({statusCircle:t})}})})})}(jQuery),jQuery.fn.wfCircularProgress=function(v){window.wfi18n.__,window.wfi18n.sprintf;jQuery(this).each(function(){var e;try{e=JSON.parse(jQuery(this).data("wfCircularProgressOptions"))}catch(e){}"object"!==_typeof(e)&&(e={});var t=jQuery.extend({},jQuery.fn.wfCircularProgress.defaults,e,v),o=Math.floor(t.diameter/2),i=o-2*t.strokeWidth,s=2*i*Math.PI,a=-(s*(1-t.endPercent)),n=-s,r=Math.floor(1.5*t.strokeWidth),c=2*r,l=(Math.cos(2*Math.PI*(t.endPercent-.25)),Math.sin(2*Math.PI*(t.endPercent-.25)),o-i*Math.cos(2*Math.PI*(t.startPercent-.25))),d=o+i*Math.sin(2*Math.PI*(t.startPercent-.25)),u="m 0,-"+r+" a "+r+","+r+" 0 1 1 0,"+c+" a "+r+","+r+" 0 1 1 0,-"+c;jQuery(this).data("wfCircularProgressOptions",JSON.stringify(t)),jQuery(this).css("width",t.diameter+"px"),jQuery(this).css("height",t.diameter+"px");var f=jQuery(this).find("svg");0==f.length&&(f=document.createElementNS("http://www.w3.org/2000/svg","svg"),jQuery(this).append(f));var p=jQuery(this).find(".wf-status-circular-inactive-path");0==p.length&&(p=document.createElementNS("http://www.w3.org/2000/svg","path"),jQuery(p).addClass("wf-status-circular-inactive-path"),jQuery(f).append(p));var h=jQuery(this).find(".wf-status-circular-active-path");0==h.length&&(h=document.createElementNS("http://www.w3.org/2000/svg","path"),jQuery(h).addClass("wf-status-circular-active-path"),jQuery(f).append(h));var w=jQuery(this).find(".wf-status-circular-terminator");0==w.length&&(w=document.createElementNS("http://www.w3.org/2000/svg","path"),jQuery(w).addClass("wf-status-circular-terminator"),jQuery(f).append(w));var g=jQuery(this).find(".wf-status-circular-text");0==g.length&&(g=jQuery('<div class="wf-status-circular-text"></div>'),jQuery(this).append(g));var m=jQuery(this).find(".wf-status-overlay-text");0==m.length&&(m=jQuery('<div class="wf-status-overlay-text"></div>'),jQuery(this).append(m)),jQuery(f).attr("viewBox","0 0 "+t.diameter+" "+t.diameter),jQuery(f).css("display","block"),jQuery(f).css("width",t.diameter+"px"),jQuery(f).css("height",t.diameter+"px"),jQuery(p).attr("d","M "+o+","+o+" m 0,-"+i+" a "+i+","+i+" 0 1 1 0,"+2*i+" a "+i+","+i+" 0 1 1 0,-"+2*i),jQuery(p).attr("stroke",t.inactiveColor),jQuery(p).attr("stroke-width",t.strokeWidth),jQuery(p).attr("fill-opacity",0),jQuery(h).attr("d","M "+o+","+o+" m 0,-"+i+" a "+i+","+i+" 0 1 1 0,"+2*i+" a "+i+","+i+" 0 1 1 0,-"+2*i),jQuery(h).attr("stroke",t.color),jQuery(h).attr("stroke-width",t.strokeWidth),jQuery(h).attr("stroke-dasharray",s+","+s),jQuery(h).attr("stroke-dashoffset",n),jQuery(h).attr("fill-opacity",0),jQuery(w).attr("d","M "+l+","+d+" "+u),jQuery(w).attr("stroke",t.color),jQuery(w).attr("stroke-width",t.strokeWidth),jQuery(w).attr("fill","#ffffff"),jQuery(m).html(t.pendingMessage),jQuery(m).animate({opacity:t.pendingOverlay?1:0},{duration:500,step:function(e){var t=1-.8*e;jQuery(f).css("opacity",t),jQuery(g).css("opacity",t)},complete:function(){jQuery(f).css("opacity",t.pendingOverlay?.2:1),jQuery(g).css("opacity",t.pendingOverlay?.2:1)}}),jQuery(h).animate({"stroke-dashoffset":a+"px"},{duration:500,step:function(e){var t=1+e/s,a=o-i*Math.cos(2*Math.PI*(t-.25)),n=o+i*Math.sin(2*Math.PI*(t-.25));jQuery(w).attr("d","M "+a+","+n+" "+u),g.html(Math.round(100*t)+"%")},complete:function(){g.html(Math.round(100*t.endPercent)+"%")}})})},function(){var e=window.wfi18n.__;window.wfi18n.sprintf;jQuery.fn.wfCircularProgress.defaults={startPercent:0,endPercent:1,color:"#16bc9b",inactiveColor:"#ececec",strokeWidth:3,diameter:100,pendingOverlay:!1,pendingMessage:e("Note: Status will update when changes are saved")}}(),function(o,e){e.wfi18n.__,e.wfi18n.sprintf;var i={width:"600px",clickOverlayDismiss:!1,content:!1,onComplete:!1};(o.fn.wfDrawer=o.wfDrawer=function(e){var t=o.extend({},i,e),a=o('<div class="wf-drawer-overlay"></div>').css("opacity",0);t.clickOverlayDismiss&&a.on("click",function(e){e.preventDefault(),e.stopPropagation(),o.wfDrawer.close()}),o("body").append(a);var n=o('<div class="wf-drawer"></div>').css("width",t.width).css("right","-"+t.width);t.content&&n.append(t.content),o("body").append(n),a.animate({opacity:1}),n.animate({right:"0px"},{complete:function(){"function"==typeof t.onComplete&&t.onComplete()}})}).close=function(){var e=o(".wf-drawer-overlay");e.animate({opacity:0},{complete:function(){e.remove()}});var t=o(".wf-drawer");t.animate({right:"-"+t.css("width")},{complete:function(){t.remove()}})}}(jQuery,(document,window)),function(r,e){var c=e.wfi18n.__,l=(e.wfi18n.sprintf,{width:"280px",clickOverlayDismiss:!0,menuItems:[],onDismiss:!1});(r.fn.wfMobileMenu=r.wfMobileMenu=function(e){var t=r.extend({},l,e),a=r('<div class="wf-mobile-menu-overlay"></div>').css("opacity",0);t.clickOverlayDismiss&&a.on("click",function(e){e.preventDefault(),e.stopPropagation(),"function"==typeof t.onDismiss&&t.onDismiss(!1),r.wfMobileMenu.close()}),r("body").append(a);for(var n,o=r('<div class="wf-mobile-menu"><ul class="wf-mobile-menu-items"></ul></div>').css("width",t.width).css("bottom","-9999px"),i=o.find(".wf-mobile-menu-items"),s=0;s<t.menuItems.length;s++){(n=r('<li><a href="#" class="wf-btn wf-btn-callout-subtle" role="button"></a></li>')).find("a").text(t.menuItems[s].title).css("width",t.width).on("click",null,{action:t.menuItems[s].action},function(e){e.preventDefault(),e.stopPropagation(),"function"==typeof t.onDismiss&&t.onDismiss(!0),r.wfMobileMenu.close(),e.data.action()}),t.menuItems[s].primary?n.find("a").addClass("wf-btn-primary"):n.find("a").addClass("wf-btn-default"),t.menuItems[s].disabled&&n.find("a").addClass("wf-disabled"),i.append(n)}(n=r('<li class="wf-padding-add-top-small"><a href="#" class="wf-btn wf-btn-callout-subtle wf-btn-default" role="button">'+c("Close")+"</a></li>")).find("a").css("width",t.width).on("click",function(e){e.preventDefault(),e.stopPropagation(),"function"==typeof t.onDismiss&&t.onDismiss(!1),r.wfMobileMenu.close()}),i.append(n),r("body").append(o),o.css("bottom","-"+o.height()+"px"),a.animate({opacity:1}),o.animate({bottom:"0px"},{complete:function(){"function"==typeof t.onComplete&&t.onComplete()}})}).close=function(){var e=r(".wf-mobile-menu-overlay");e.animate({opacity:0},{complete:function(){e.remove()}});var t=r(".wf-mobile-menu");t.animate({bottom:"-"+t.height()+"px"},{complete:function(){t.remove()}})}}(jQuery,(document,window));var saveAs=saveAs||function(r){if(!(void 0===r||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=r.document,c=function(){return r.URL||r.webkitURL||r},l=e.createElementNS("http://www.w3.org/1999/xhtml","a"),d="download"in l,u=/constructor/i.test(r.HTMLElement),f=/CriOS\/[\d]+/.test(navigator.userAgent),p=function(e){setTimeout(function(){"string"==typeof e?c().revokeObjectURL(e):e.remove()},4e4)},h=function(e,t,a){for(var n=(t=[].concat(t)).length;n--;){var o=e["on"+t[n]];if("function"==typeof o)try{o.call(e,a||e)}catch(e){!function(e){(r.setImmediate||r.setTimeout)(function(){throw e},0)}(e)}}},w=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},n=function(e,a,t){t||(e=w(e));function n(){h(i,"writestart progress write writeend".split(" "))}var o,i=this,s="application/octet-stream"===e.type;if(i.readyState=i.INIT,d)return o=c().createObjectURL(e),void setTimeout(function(){var e,t;l.href=o,l.download=a,e=l,t=new MouseEvent("click"),e.dispatchEvent(t),n(),p(o),i.readyState=i.DONE});!function(){if((f||s&&u)&&r.FileReader){var t=new FileReader;return t.onloadend=function(){var e=f?t.result:t.result.replace(/^data:[^;]*;/,"data:attachment/file;");r.open(e,"_blank")||(r.location.href=e),e=void 0,i.readyState=i.DONE,n()},t.readAsDataURL(e),i.readyState=i.INIT}o=o||c().createObjectURL(e),!s&&r.open(o,"_blank")||(r.location.href=o),i.readyState=i.DONE,n(),p(o)}()},t=n.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,a){return t=t||e.name||"download",a||(e=w(e)),navigator.msSaveOrOpenBlob(e,t)}:(t.abort=function(){},t.readyState=t.INIT=0,t.WRITING=1,t.DONE=2,t.error=t.onwritestart=t.onprogress=t.onwrite=t.onabort=t.onerror=t.onwriteend=null,function(e,t,a){return new n(e,t||e.name||"download",a)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||(void 0).content);"undefined"!=typeof module&&module.exports?module.exports.saveAs=saveAs:"undefined"!=typeof define&&null!==define&&null!==define.amd&&define([],function(){return saveAs}),function(e){if(e.URL=e.URL||e.webkitURL,e.Blob&&e.URL)try{return new Blob}catch(e){}var r=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||function(e){function r(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]}function t(){this.data=[]}function c(e,t,a){this.data=e,this.size=e.length,this.type=t,this.encoding=a}function l(e){this.code=this[this.name=e]}var a=t.prototype,n=c.prototype,d=e.FileReaderSync,o="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),i=o.length,s=e.URL||e.webkitURL||e,u=s.createObjectURL,f=s.revokeObjectURL,p=s,h=e.btoa,w=e.atob,g=e.ArrayBuffer,m=e.Uint8Array,v=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;for(c.fake=n.fake=!0;i--;)l.prototype[o[i]]=i+1;return s.createObjectURL||(p=e.URL=function(e){var t,a=document.createElementNS("http://www.w3.org/1999/xhtml","a");return a.href=e,"origin"in a||("data:"===a.protocol.toLowerCase()?a.origin=null:(t=e.match(v),a.origin=t&&t[1])),a}),p.createObjectURL=function(e){var t,a=e.type;return null===a&&(a="application/octet-stream"),e instanceof c?(t="data:"+a,"base64"===e.encoding?t+";base64,"+e.data:"URI"===e.encoding?t+","+decodeURIComponent(e.data):h?t+";base64,"+h(e.data):t+","+encodeURIComponent(e.data)):u?u.call(s,e):void 0},p.revokeObjectURL=function(e){"data:"!==e.substring(0,5)&&f&&f.call(s,e)},a.append=function(e){var t=this.data;if(m&&(e instanceof g||e instanceof m)){for(var a="",n=new m(e),o=0,i=n.length;o<i;o++)a+=String.fromCharCode(n[o]);t.push(a)}else if("Blob"===r(e)||"File"===r(e)){if(!d)throw new l("NOT_READABLE_ERR");var s=new d;t.push(s.readAsBinaryString(e))}else e instanceof c?"base64"===e.encoding&&w?t.push(w(e.data)):"URI"===e.encoding?t.push(decodeURIComponent(e.data)):"raw"===e.encoding&&t.push(e.data):("string"!=typeof e&&(e+=""),t.push(unescape(encodeURIComponent(e))))},a.getBlob=function(e){return arguments.length||(e=null),new c(this.data.join(""),e,"raw")},a.toString=function(){return"[object BlobBuilder]"},n.slice=function(e,t,a){var n=arguments.length;return n<3&&(a=null),new c(this.data.slice(e,1<n?t:this.data.length),a,this.encoding)},n.toString=function(){return"[object Blob]"},n.close=function(){this.size=0,delete this.data},t}(e);e.Blob=function(e,t){var a=t&&t.type||"",n=new r;if(e)for(var o=0,i=e.length;o<i;o++)Uint8Array&&e[o]instanceof Uint8Array?n.append(e[o].buffer):n.append(e[o]);var s=n.getBlob(a);return!s.slice&&s.webkitSlice&&(s.slice=s.webkitSlice),s};var t=Object.getPrototypeOf||function(e){return e.__proto__};e.Blob.prototype=t(new e.Blob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||(void 0).content||void 0);